<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Redis集群 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Redis集群">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis集群">
<meta property="og:url" content="http://example.com/2020/12/13/07-Redis/03-Redis%E9%9B%86%E7%BE%A4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Redis集群">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213144607160.png">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213150708673.png">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213150830579.png">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213160521011.png">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213151234846.png">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213163559881.png">
<meta property="og:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213163638307.png">
<meta property="article:published_time" content="2020-12-13T06:44:33.000Z">
<meta property="article:modified_time" content="2022-09-25T13:37:30.461Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Redis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213144607160.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-07-Redis/03-Redis集群" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/13/07-Redis/03-Redis%E9%9B%86%E7%BE%A4/" class="article-date">
  <time class="dt-published" datetime="2020-12-13T06:44:33.000Z" itemprop="datePublished">2020-12-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Redis/">Redis</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Redis集群
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Redis集群</p>
<span id="more"></span>

<h1 id="1-搭建高可用集群"><a href="#1-搭建高可用集群" class="headerlink" title="1 搭建高可用集群"></a>1 搭建高可用集群</h1><h2 id="1-1-Redis主从集群架构分析"><a href="#1-1-Redis主从集群架构分析" class="headerlink" title="1.1 Redis主从集群架构分析"></a>1.1 Redis主从集群架构分析</h2><p>什么是主从复制？</p>
<p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213144607160.png" alt="image-20201213144607160"></p>
<p>为什么要使用主从复制？</p>
<ul>
<li><p>redis-server单点故障</p>
</li>
<li><p>单节点QPS有限</p>
</li>
<li><p>持久化，从处理持久化，避免对主性能影响</p>
</li>
</ul>
<p>主从复制应用场景分析</p>
<ul>
<li><p>读写分离场景，规避redis单机瓶颈</p>
</li>
<li><p>故障切换，master出问题后还有slave节点可以使用</p>
</li>
</ul>
<h2 id="1-2-搭建主从复制"><a href="#1-2-搭建主从复制" class="headerlink" title="1.2 搭建主从复制"></a>1.2 搭建主从复制</h2><p>主Redis Server以普通模式启动，主要是启动从服务器的方式</p>
<ol>
<li><p>第一种方式：命令行</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">连接需要实现从节点的redis，执行下面的命令</span></span><br><span class="line">slaveof [ip] [port]</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二种方式：redis.conf 配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置文件中增加</span></span><br><span class="line">slaveof [ip] [port]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从服务器是否只读(默认<span class="built_in">yes</span>)</span></span><br><span class="line">slave-read-only yes</span><br></pre></td></tr></table></figure></li>
</ol>
<p>退出主从集群的方式</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">slaveof no one</span><br></pre></td></tr></table></figure>



<h2 id="1-3-查看主从复制信息"><a href="#1-3-查看主从复制信息" class="headerlink" title="1.3 查看主从复制信息"></a>1.3 查看主从复制信息</h2><p><strong>master</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Replication</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">角色</span></span><br><span class="line">role:master</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前从服务器数量1</span></span><br><span class="line">connected_slaves:1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从服务器信息</span></span><br><span class="line">slave0:ip=192.168.254.160,port=6380,state=online,offset=14,lag=1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">同步+offset</span></span><br><span class="line">master_replid:cf4e2ce09b445efc6760f2d1fb516dd4d7096e00</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">故障转移情况下使用</span></span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">计数器，主节点复制偏移量(复制的字节数)</span></span><br><span class="line">master_repl_offset:14</span><br><span class="line">second_repl_offset:-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主从同步缓存区</span></span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:14</span><br></pre></td></tr></table></figure>



<p><strong>slave</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; info replication</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Replication</span></span><br><span class="line">role:slave</span><br><span class="line">master_host:192.168.254.160</span><br><span class="line">master_port:6379</span><br><span class="line">master_link_status:up</span><br><span class="line">master_last_io_seconds_ago:9</span><br><span class="line">master_sync_in_progress:0</span><br><span class="line">slave_repl_offset:14</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从节点优先级</span></span><br><span class="line">slave_priority:100</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">是否为只读节点</span></span><br><span class="line">slave_read_only:1</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_replid:cf4e2ce09b445efc6760f2d1fb516dd4d7096e00</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:14</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:1</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:1</span><br><span class="line">repl_backlog_histlen:14</span><br></pre></td></tr></table></figure>



<h2 id="1-4-主从复制流程"><a href="#1-4-主从复制流程" class="headerlink" title="1.4 主从复制流程"></a>1.4 主从复制流程</h2><p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213150708673.png" alt="image-20201213150708673"></p>
<ol>
<li><p>从服务器通过psync命令发送服务器已有的同步进度(同步源ID、同步进度offset)</p>
</li>
<li><p>master收到请求，同步源为当前master，则根据偏移量增量同步</p>
</li>
<li><p>同步源非当前master，则进入全量同步：master生成rdb，传输到slave，加载到slave内存</p>
</li>
</ol>
<h2 id="1-5-主从复制核心知识"><a href="#1-5-主从复制核心知识" class="headerlink" title="1.5 主从复制核心知识"></a>1.5 主从复制核心知识</h2><ul>
<li><p>Redis 默认使用异步复制，slave 和 master 之间异步地确认处理的数据量</p>
</li>
<li><p>一个 master 可以拥有多个 slave</p>
</li>
<li><p>slave 可以接受其他 slave 的连接。 slave 可以有下级sub slave</p>
</li>
<li><p>主从同步过程在 master 侧是非阻塞的</p>
</li>
<li><p>slave初次同步需要删除旧数据，加载新数据，会阻塞到来的连接请求</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213150830579.png" alt="image-20201213150830579"></p>
<p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213160521011.png" alt="image-20201213160521011"></p>
<h2 id="1-6-主从复制应用场景"><a href="#1-6-主从复制应用场景" class="headerlink" title="1.6 主从复制应用场景"></a>1.6 主从复制应用场景</h2><ul>
<li><p>主从复制可以用来支持读写分离</p>
</li>
<li><p>slave服务器设定为只读，可以用在数据安全的场景下。</p>
</li>
<li><p>可以使用主从复制来避免 master 持久化造成的开销。master 关闭持久化，slave 配置为不定期保存或是启用 AOF。（注意：重新启动的 master 程序将从一个空数据集开始，如果一个 slave 试图与它同步，那么这个 slave 也会被清空。 ）</p>
</li>
</ul>
<p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213151234846.png" alt="image-20201213151234846"></p>
<h2 id="1-7-主从复制的注意事项"><a href="#1-7-主从复制的注意事项" class="headerlink" title="1.7 主从复制的注意事项"></a>1.7 主从复制的注意事项</h2><p>读写分离场景：</p>
<ul>
<li><p>数据复制延时导致读到过期数据或者读不到数据（网络原因、slave阻塞）</p>
</li>
<li><p>从节点故障（多个client如何迁移）</p>
</li>
</ul>
<p>全量复制情况下：</p>
<ul>
<li><p>第一次建立主从关系或者runid不匹配会导致全量复制</p>
</li>
<li><p>故障转移的时候也会出现全量复制</p>
</li>
</ul>
<p>复制风暴：</p>
<ul>
<li><p>master故障重启，如果slave节点较多，所有slave都要复制，对服务器的性能，网络的压力都有很大影响。</p>
</li>
<li><p>如果一个机器部署了多个master</p>
</li>
</ul>
<p>写能力有限</p>
<ul>
<li>主从复制还是只有一台master，提供的写服务能力有限</li>
</ul>
<p>master故障情况下：</p>
<ul>
<li><p>如果是master无持久化，slave开启持久化来保留数据的场景，建议不要配置redis自动重启。</p>
</li>
<li><p>启动redis自动重启，master启动后，无备份数据，可能导致集群数据丢失的情况。</p>
</li>
</ul>
<p>带有效期的key： </p>
<ul>
<li><p>slave不会让key过期，而是等待 master 让 key 过期</p>
</li>
<li><p>在Lua脚本执行期间，不执行任何 key 过期操作</p>
</li>
</ul>
<h2 id="1-8-redis-info命令详解"><a href="#1-8-redis-info命令详解" class="headerlink" title="1.8 redis-info命令详解"></a>1.8 redis-info命令详解</h2><h3 id="1-8-1-Server-服务器基本信息"><a href="#1-8-1-Server-服务器基本信息" class="headerlink" title="1.8.1 Server 服务器基本信息"></a>1.8.1 Server 服务器基本信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">redis版本号</span></span><br><span class="line">redis_version:5.0.3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">redis源码包git信息</span></span><br><span class="line">redis_git_sha1:00000000</span><br><span class="line">redis_git_dirty:0</span><br><span class="line">redis_build_id:da69b07a37c06dc8</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行模式(“独立”，“哨兵”或“集群”)</span></span><br><span class="line">redis_mode:standalone</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">操作系统信息</span></span><br><span class="line">os:Linux 3.10.0-514.el7.x86_64 x86_64</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">64位架构</span></span><br><span class="line">arch_bits:64</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编译运行的底层依赖信息</span></span><br><span class="line">multiplexing_api:epoll</span><br><span class="line">atomicvar_api:atomic-builtin</span><br><span class="line">gcc_version:4.8.5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进程ID</span></span><br><span class="line">process_id:10040</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">实例运行的随机值标识符(sentinel和集群中有用)</span></span><br><span class="line">run_id:df903681f11f712523e0615cd4c7e45afbf500b6</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">端口</span></span><br><span class="line">tcp_port:6379</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行时长</span></span><br><span class="line">uptime_in_seconds:42593</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">运行时长(天)</span></span><br><span class="line">uptime_in_days:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务器的频率设置</span></span><br><span class="line">hz:10</span><br><span class="line">configured_hz:10</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">LRU运作的时钟(分钟为单位)</span></span><br><span class="line">lru_clock:7473903</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可执行文件</span></span><br><span class="line">executable:/usr/local/redis/./bin/redis-server</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前读取的配置</span></span><br><span class="line">config_file:/usr/local/redis/conf/redis_6379.conf</span><br></pre></td></tr></table></figure>

<h3 id="1-8-2-Clients-客户端连接信息"><a href="#1-8-2-Clients-客户端连接信息" class="headerlink" title="1.8.2 Clients 客户端连接信息"></a>1.8.2 Clients 客户端连接信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">连接数</span></span><br><span class="line">connected_clients:1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">客户端输入缓冲区</span></span><br><span class="line">client_recent_max_input_buffer:2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">客户端输出缓冲区</span></span><br><span class="line">client_recent_max_output_buffer:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">阻塞的客户端数量(卡住了就看看这个)</span></span><br><span class="line">blocked_clients:0</span><br></pre></td></tr></table></figure>

<h3 id="1-8-3-Memory内存信息"><a href="#1-8-3-Memory内存信息" class="headerlink" title="1.8.3 Memory内存信息"></a>1.8.3 Memory内存信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内存总量(字节数)</span></span><br><span class="line">used_memory:854280</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内存总量(更方便查看的格式)</span></span><br><span class="line">used_memory_human:834.26K</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">已分配的内存总量</span></span><br><span class="line">used_memory_rss:8388608</span><br><span class="line">used_memory_rss_human:8.00M</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内存消耗峰值</span></span><br><span class="line">used_memory_peak:854280</span><br><span class="line">used_memory_peak_human:834.26K</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">峰值内存占用的内存百分比</span></span><br><span class="line">used_memory_peak_perc:100.15%</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内部机制所需的内存</span></span><br><span class="line">used_memory_overhead:840838</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动时消耗的内存</span></span><br><span class="line">used_memory_startup:791032</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据占用的内存大小</span></span><br><span class="line">used_memory_dataset:13442</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据占用的内存大小百分比</span></span><br><span class="line">used_memory_dataset_perc:21.25%</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">未说明（从名字可以看出是内存申请的信息）</span></span><br><span class="line">allocator_allocated:844856</span><br><span class="line">allocator_active:1011712</span><br><span class="line">allocator_resident:3665920</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">整个系统内存</span></span><br><span class="line">total_system_memory:1041199104</span><br><span class="line">total_system_memory_human:992.96M</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Lua脚本存储占用的内存</span></span><br><span class="line">used_memory_lua:37888</span><br><span class="line">used_memory_lua_human:37.00K</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">未说明</span></span><br><span class="line">used_memory_scripts:0</span><br><span class="line">used_memory_scripts_human:0B</span><br><span class="line">number_of_cached_scripts:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最大内存配置</span></span><br><span class="line">maxmemory:0</span><br><span class="line">maxmemory_human:0B</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内存管理策略</span></span><br><span class="line">maxmemory_policy:noeviction</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">官方未说明</span></span><br><span class="line">allocator_frag_ratio:1.20</span><br><span class="line">allocator_frag_bytes:166856</span><br><span class="line">allocator_rss_ratio:3.62</span><br><span class="line">allocator_rss_bytes:2654208</span><br><span class="line">rss_overhead_ratio:2.29</span><br><span class="line">rss_overhead_bytes:4722688</span><br><span class="line">mem_fragmentation_ratio:10.33</span><br><span class="line">mem_fragmentation_bytes:7576576</span><br><span class="line">mem_not_counted_for_evict:0</span><br><span class="line">mem_replication_backlog:0</span><br><span class="line">mem_clients_slaves:0</span><br><span class="line">mem_clients_normal:49694</span><br><span class="line">mem_aof_buffer:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">内存分配器，在编译时选择</span></span><br><span class="line">mem_allocator:jemalloc-5.1.0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">碎片整理是否存于活动状态</span></span><br><span class="line">active_defrag_running:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">等待被释放的对象数量</span></span><br><span class="line">lazyfree_pending_objects:0</span><br></pre></td></tr></table></figure>

<h3 id="1-8-4-Persistence持久化相关"><a href="#1-8-4-Persistence持久化相关" class="headerlink" title="1.8.4 Persistence持久化相关"></a>1.8.4 Persistence持久化相关</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">表示Redis是否正在加载备份文件的标志</span></span><br><span class="line">loading:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从最近一次转储至今，RDB的修改次数</span></span><br><span class="line">rdb_changes_since_last_save:2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">表示Redis正在保存RDB的标志</span></span><br><span class="line">rdb_bgsave_in_progress:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上次RDB成功保存的时间戳</span></span><br><span class="line">rdb_last_save_time:1550935182</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最后一次RDB保存操作的状态</span></span><br><span class="line">rdb_last_bgsave_status:ok</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最后一次RDB保存操作的持续时间（以秒为单位）</span></span><br><span class="line">rdb_last_bgsave_time_sec:-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">正在进行的RDB保存操作的持续时间（如果有）</span></span><br><span class="line">rdb_current_bgsave_time_sec:-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上次RBD保存操作期间写时复制分配的字节大小</span></span><br><span class="line">rdb_last_cow_size:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">表示AOF记录的标志已激活</span></span><br><span class="line">aof_enabled:1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">表示AOF重写操作的标志正在进行中</span></span><br><span class="line">aof_rewrite_in_progress:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">一旦正在进行的RDB保存完成，将指定表示AOF重写操作的标志。</span></span><br><span class="line">aof_rewrite_scheduled:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最后一次AOF重写操作的持续时间，以秒为单位</span></span><br><span class="line">aof_last_rewrite_time_sec:-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">正在进行的AOF重写操作的持续时间（如果有）</span></span><br><span class="line">aof_current_rewrite_time_sec:-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最后一次AOF重写操作的状态</span></span><br><span class="line">aof_last_bgrewrite_status:ok</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最后一次写入操作到AOF的状态</span></span><br><span class="line">aof_last_write_status:ok</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上次AOF重写操作期间写时复制分配的大小（以字节为单位）</span></span><br><span class="line">aof_last_cow_size:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">AOF当前文件大小</span></span><br><span class="line">aof_current_size:77</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最新启动或重写时的AOF文件大小</span></span><br><span class="line">aof_base_size:77</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">一旦正在进行的RDB保存完成，将指定表示AOF重写操作的标志。</span></span><br><span class="line">aof_pending_rewrite:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">AOF缓冲区的大小</span></span><br><span class="line">aof_buffer_length:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">AOF重写缓冲区的大小</span></span><br><span class="line">aof_rewrite_buffer_length:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">fsync挂起作业数</span></span><br><span class="line">aof_pending_bio_fsync:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">延迟fsync计数器</span></span><br><span class="line">aof_delayed_fsync:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">如果数据恢复中可能会有这些值</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">loading_start_time：加载操作开始的时间戳</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">loading_total_bytes：文件总大小</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">loading_loaded_bytes：已加载的字节数</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">loading_loaded_perc：相同的值表示为百分比</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">loading_eta_seconds：ETA在几秒钟内完成负载</span></span><br></pre></td></tr></table></figure>

<h3 id="1-8-5-Stats-实时监控信息"><a href="#1-8-5-Stats-实时监控信息" class="headerlink" title="1.8.5 Stats 实时监控信息"></a>1.8.5 Stats 实时监控信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis服务器接受的连接总数</span></span><br><span class="line">total_connections_received:1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis服务器处理的命令总数</span></span><br><span class="line">total_commands_processed:1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">每秒钟处理的命令数量</span></span><br><span class="line">instantaneous_ops_per_sec:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">通过网络接收的数据总量，以字节为单位</span></span><br><span class="line">total_net_input_bytes:34</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">通过网络发送的数据总量，以字节为单位</span></span><br><span class="line">total_net_output_bytes:7</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">每秒钟接收数据的速率，以kbps为单位</span></span><br><span class="line">instantaneous_input_kbps:0.00</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">每秒钟发送数据的速率，以kbps为单位</span></span><br><span class="line">instantaneous_output_kbps:0.00</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis服务器由于maxclients限制而拒绝的连接数量</span></span><br><span class="line">rejected_connections:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis主机和从机进行完全同步的次数</span></span><br><span class="line">sync_full:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis服务器接受PSYNC请求的次数</span></span><br><span class="line">sync_partial_ok:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis服务器拒绝PSYNC请求的次数</span></span><br><span class="line">sync_partial_err:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">键过期事件的总数</span></span><br><span class="line">expired_keys:0</span><br><span class="line">expired_stale_perc:0.00</span><br><span class="line">expired_time_cap_reached_count:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">由于maxmemory限制，而被回收内存的键的总数</span></span><br><span class="line">evicted_keys:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在主字典中成功查找到键的次数</span></span><br><span class="line">keyspace_hits:1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在主字典中未能成功查找到键的次数</span></span><br><span class="line">keyspace_misses:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">发布/订阅频道的总数量</span></span><br><span class="line">pubsub_channels:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">客户端订阅的发布/订阅模式的总数量</span></span><br><span class="line">pubsub_patterns:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">最近一次fork操作消耗的时间，以微秒为单位</span></span><br><span class="line">latest_fork_usec:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">迁移已缓存的套接字的数量</span></span><br><span class="line">migrate_cached_sockets:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">为实现key过期而跟踪的key数数量（仅适用于可写副本）</span></span><br><span class="line">slave_expires_tracked_keys:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">碎片整理过程执行的值重新分配的数量</span></span><br><span class="line">active_defrag_hits:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">碎片整理过程启动的中止值重新分配数</span></span><br><span class="line">active_defrag_misses:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">碎片整理的key数量</span></span><br><span class="line">active_defrag_key_hits:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">碎片整理过程跳过的key数量</span></span><br><span class="line">active_defrag_key_misses:0</span><br></pre></td></tr></table></figure>

<h3 id="1-8-6-Replication主从复制相关信息"><a href="#1-8-6-Replication主从复制相关信息" class="headerlink" title="1.8.6 Replication主从复制相关信息"></a>1.8.6 Replication主从复制相关信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">角色 master或者 slave</span></span><br><span class="line">role:master</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">已连接的Redis从机的数量</span></span><br><span class="line">connected_slaves:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主从复制过程中master的标识<span class="built_in">id</span></span></span><br><span class="line">master_replid:6ea01bd968c7f14cb6de138462ddaf11930a4269</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">全局的复制偏移量</span></span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">表示Redis服务器是否为部分同步开启复制备份日志</span></span><br><span class="line">repl_backlog_active:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份日志的循环缓冲区的大小</span></span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份日志缓冲区中的首个字节的复制偏移量</span></span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份日志的实际数据长度</span></span><br><span class="line">repl_backlog_histlen:0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">主从复制情况下可能会有的一些额外信息</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_host：Redis主机的主机名或IP地址</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_port：Redis主机监听的TCP端口</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_link_status：链路状态（连接/断开</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_last_io_seconds_ago：最近一次和Redis主机交互至今的消耗时间，以秒为单位</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_sync_in_progress：表示Redis主机正在将数据同步至从机</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_sync_left_bytes：在同步完成之前，还剩余的数据总量，以字节为单位</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_sync_last_io_seconds_ago：在一次SYNC操作期间，最近一次传输数据的I/O操作至今的消耗时间，以秒为单位</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master_link_down_since_seconds：从链路断开至今的时间，以秒为单位</span></span><br></pre></td></tr></table></figure>

<h3 id="1-8-7-CPU信息"><a href="#1-8-7-CPU信息" class="headerlink" title="1.8.7 CPU信息"></a>1.8.7 CPU信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务器耗费的系统 CPU</span></span><br><span class="line">used_cpu_sys:26.932586</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务器耗费的用户 CPU</span></span><br><span class="line">used_cpu_user:36.964424</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">后台进程耗费的系统 CPU</span></span><br><span class="line">used_cpu_sys_children:0.000000</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">后台进程耗费的用户 CPU</span></span><br><span class="line">used_cpu_user_children:0.000000</span><br></pre></td></tr></table></figure>

<h3 id="1-8-8-Cluster集群信息"><a href="#1-8-8-Cluster集群信息" class="headerlink" title="1.8.8 Cluster集群信息"></a>1.8.8 Cluster集群信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">一个标志值，记录集群功能是否已经开启</span></span><br><span class="line">cluster_enabled:0</span><br></pre></td></tr></table></figure>

<h3 id="1-8-9-Keyspace键存储空间信息"><a href="#1-8-9-Keyspace键存储空间信息" class="headerlink" title="1.8.9 Keyspace键存储空间信息"></a>1.8.9 Keyspace键存储空间信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数据库的key数量、处于有效时间内的key数量，过期key数量</span></span><br><span class="line">db0:keys=2,expires=0,avg_ttl=0</span><br></pre></td></tr></table></figure>



<h2 id="1-9-redis-conf配置详解"><a href="#1-9-redis-conf配置详解" class="headerlink" title="1.9 redis.conf配置详解"></a>1.9 redis.conf配置详解</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis configuration file example.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Note that in order to read the configuration file, Redis must be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">started with the file path as first argument:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># ./redis-server /path/to/redis.conf</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Note on units: when memory size is needed, it is possible to specify</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">it <span class="keyword">in</span> the usual form of 1k 5GB 4M and so forth:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 1k =&gt; 1000 bytes</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1kb =&gt; 1024 bytes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1m =&gt; 1000000 bytes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1mb =&gt; 1024*1024 bytes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1g =&gt; 1000000000 bytes</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1gb =&gt; 1024*1024*1024 bytes</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># units are case insensitive so 1GB 1Gb 1gB are all the same.</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">################################# INCLUDES ###################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Include one or more other config files here.  This is useful <span class="keyword">if</span> you</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">have a standard template that goes to all Redis servers but also need</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to customize a few per-server settings.  Include files can include</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">other files, so use this wisely.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Notice option &quot;include&quot; won&#x27;t be rewritten by command &quot;CONFIG REWRITE&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">from admin or Redis Sentinel. Since Redis always uses the last processed</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">line as value of a configuration directive, you<span class="string">&#x27;d better put includes</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">at the beginning of this file to avoid overwriting config change at runtime.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If instead you are interested in using includes to override configuration</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">options, it is better to use include as the last line.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># include /path/to/local.conf</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">include /path/to/other.conf</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">额外载入配置文件，如果需要的话，可以开启此配置</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">################################# MODULES #####################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Load modules at startup. If the server is not able to load modules</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">it will abort. It is possible to use multiple loadmodule directives.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># loadmodule /path/to/my_module.so</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">loadmodule /path/to/other_module.so</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">################################# NETWORK #####################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">By default, if no &quot;bind&quot; configuration directive is specified, Redis listens</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">for connections from all the network interfaces available on the server.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">It is possible to listen to just one or multiple selected interfaces using</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the &quot;bind&quot; configuration directive, followed by one or more IP addresses.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Examples:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># bind 192.168.1.100 10.0.0.1</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">bind 127.0.0.1 ::1</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">internet, binding to all the interfaces is dangerous and will expose the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">instance to everybody on the internet. So by default we uncomment the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">following bind directive, that will force Redis to listen only into</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the IPv4 loopback interface address (this means Redis will be able to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">accept connections only from clients running into the same computer it</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">is running).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">JUST COMMENT THE FOLLOWING LINE.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">bind 127.0.0.1</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">绑定redis服务器网卡IP，默认为127.0.0.1,即本地回环地址。这样的话，访问redis服务只能通过本机的客户端连接，而无法通过远程连接。如果bind选项为空的话，那会接受所有来自于可用网络接口的连接。如上配置，绑定一个127.0.0.1的本机地址和192.168.1.100的外网地址。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Protected mode is a layer of security protection, in order to avoid that</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis instances left open on the internet are accessed and exploited.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># When protected mode is on and if:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1) The server is not binding explicitly to a set of addresses using the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   &quot;bind&quot; directive.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">2) No password is configured.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The server only accepts connections from clients connecting from the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">sockets.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># By default protected mode is enabled. You should disable it only if</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">you are sure you want clients from other hosts to connect to Redis</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">even if no authentication is configured, nor a specific set of interfaces</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">are explicitly listed using the &quot;bind&quot; directive.</span></span></span><br><span class="line">protected-mode yes</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">保护模式，默认是开启状态，只允许本地客户端连接，可以设置密码或添加bind来连接</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Accept connections on the specified port, default is 6379 (IANA #815344).</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If port 0 is specified Redis will not listen on a TCP socket.</span></span></span><br><span class="line">port 6379</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">监听端口号，默认为6379，如果设置为0，redis将不在socket上监听任何客户端连接</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">TCP listen() backlog.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># In high requests-per-second environments you need an high backlog in order</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">to avoid slow clients connections issues. Note that the Linux kernel</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">will silently truncate it to the value of /proc/sys/net/core/somaxconn so</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">make sure to raise both the value of somaxconn and tcp_max_syn_backlog</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in order to get the desired effect.</span></span></span><br><span class="line">tcp-backlog 511</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">TCP监听的最大容量，在高并发的环境下，你需要把这个值调高以避免客户端连接缓慢的问题。Linux内核会把这个值缩小成/proc/sys/net/core/somaxconn对应的值，要提升并发量需要修改这两个值才能达到目的</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">在/etc/sysctl.conf中添加net.core.somaxconn = 2048再执行sysctl -p</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Unix socket.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Specify the path for the Unix socket that will be used to listen for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">incoming connections. There is no default, so Redis will not listen</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">on a unix socket when not specified.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># unixsocket /tmp/redis.sock</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">unixsocketperm 700</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">指定redis监听的unix socket路径，默认不启用，unixsocketper指定文件的权限</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Close the connection after a client is idle for N seconds (0 to disable)</span></span></span><br><span class="line">timeout 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">指定在一个client空闲多少秒之后关闭连接（0表示永不关闭）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">TCP keepalive.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If non-zero, use SO_KEEPALIVE to send TCP ACKs to clients in absence</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">of communication. This is useful for two reasons:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1) Detect dead peers.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">2) Take the connection alive from the point of view of network</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   equipment in the middle.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># On Linux, the specified value (in seconds) is the period used to send ACKs.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Note that to close the connection the double of the time is needed.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">On other kernels the period depends on the kernel configuration.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># A reasonable value for this option is 300 seconds, which is the new</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis default starting with Redis 3.2.1.</span></span></span><br><span class="line">tcp-keepalive 300</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">单位是秒，表示将周期性的使用SO_KEEPALIVE检测客户端是否还处于健康状态，避免服务器一直阻塞，官方给出的建议值是300s，如果设置为0，则不会周期性的检测</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">################################ GENERAL #####################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">By default Redis does not run as a daemon. Use &#x27;</span><span class="built_in">yes</span><span class="string">&#x27; if you need it.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Note that Redis will write a pid file in /var/run/redis.pid when daemonized.</span></span></span><br><span class="line">daemonize no</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">默认情况下redis不是作为守护进程运行的，如果你想让它在后台运行，你就把它改成yes.当redis作为守护进程运行的时候，它会写一个pid到/var/run/redis.pid文件里面</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If you run Redis from upstart or systemd, Redis can interact with your</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">supervision tree. Options:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised no      - no supervision interaction</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised upstart - signal upstart by putting Redis into SIGSTOP mode</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised auto    - detect upstart or systemd method based on</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">                       UPSTART_JOB or NOTIFY_SOCKET environment variables</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Note: these supervision methods only signal &quot;process is ready.&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">      They do not enable continuous liveness pings back to your supervisor.</span></span></span><br><span class="line">supervised no</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">可以通过upstart和systemd管理Redis守护进程</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">选项：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised no - 没有监督互动</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised upstart - 通过将Redis置于SIGSTOP模式来启动信号</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised systemd - signal systemd将READY = 1写入$ NOTIFY_SOCKET</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  supervised auto - 检测upstart或systemd方法基于 UPSTART_JOB或NOTIFY_SOCKET环境变量</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If a pid file is specified, Redis writes it where specified at startup</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">and removes it at exit.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># When the server runs non daemonized, no pid file is created if none is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">specified in the configuration. When the server is daemonized, the pid file</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">is used even if not specified, defaulting to &quot;/var/run/redis.pid&quot;.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Creating a pid file is best effort: if Redis is not able to create it</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">nothing bad happens, the server will start and run normally.</span></span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">配置PID文件路径，当redis作为守护线程运行时，它会把pid默认写到/var/run/redis_6379.pid里面</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Specify the server verbosity level.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">This can be one of:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">debug (a lot of information, useful for development/testing)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">verbose (many rarely useful info, but not a mess like the debug level)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">notice (moderately verbose, what you want in production probably)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">warning (only very important / critical messages are logged)</span></span></span><br><span class="line">loglevel notice</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">定义日志级别。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 可以是下面的这些值：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> debug（记录大量日志信息，适用于开发、测试阶段）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> verbose（较多日志信息）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> notice（适量日志信息，使用于生产环境）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> warning（仅有部分重要、关键信息才会被记录）</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Specify the log file name. Also the empty string can be used to force</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis to log on the standard output. Note that if you use standard</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">output for logging but daemonize, logs will be sent to /dev/null</span></span></span><br><span class="line">logfile &quot;&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">日志文件的位置，当指定为空字符串时，为标准输出，如果redis已守护进程模式运行，那么日志将会输出到/dev/null</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">To enable logging to the system logger, just set &#x27;</span>syslog-enabled<span class="string">&#x27; to yes,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">and optionally update the other syslog parameters to suit your needs.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">syslog-enabled no</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">要想把日志记录为系统日志，就把它改成yes，也可以可选择性的更新其他的syslog参数以达到你的要求</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Specify the syslog identity.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">syslog-ident redis</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">设置系统日志的ID</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Specify the syslog facility. Must be USER or between LOCAL0-LOCAL7.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">syslog-facility local0</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">指定系统日志设置，必须是 USER 或者是 LOCAL0-LOCAL7 之间的值</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Set the number of databases. The default database is DB 0, you can select</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">a different one on a per-connection basis using SELECT &lt;dbid&gt; where</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">dbid is a number between 0 and &#x27;</span>databases<span class="string">&#x27;-1</span></span></span><br><span class="line">databases 16</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">设置数据库的数目。默认的数据库是DB 0 ，可以在每个连接上使用select  &lt;dbid&gt; 命令选择一个不同的数据库，dbid是一个介于0到databases - 1 之间的数值。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">By default Redis shows an ASCII art logo only when started to log to the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">standard output and if the standard output is a TTY. Basically this means</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">that normally a logo is displayed only in interactive sessions.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># However it is possible to force the pre-4.0 behavior and always show a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">ASCII art logo in startup logs by setting the following option to yes.</span></span></span><br><span class="line">always-show-logo yes</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">############################### SNAPSHOTTING  ################################</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Save the DB on disk:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   save &lt;seconds&gt; &lt;changes&gt;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   Will save the DB if both the given number of seconds and the given</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  number of write operations against the DB occurred.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   In the example below the behaviour will be to save:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  after 900 sec (15 min) if at least 1 key changed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  after 300 sec (5 min) if at least 10 keys changed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  after 60 sec if at least 10000 keys changed</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   Note: you can disable saving completely by commenting out all &quot;save&quot; lines.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   It is also possible to remove all the previously configured save</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  points by adding a save directive with a single empty string argument</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  like in the following example:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   save &quot;&quot;</span></span></span><br><span class="line"> </span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">存 DB 到磁盘：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   格式：save &lt;间隔时间（秒）&gt; &lt;写入次数&gt;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   根据给定的时间间隔和写入次数将数据保存到磁盘</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   下面的例子的意思是：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   900 秒内如果至少有 1 个 key 的值变化，则保存</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   300 秒内如果至少有 10 个 key 的值变化，则保存</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   60 秒内如果至少有 10000 个 key 的值变化，则保存</span></span>　</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   注意：你可以注释掉所有的 save 行来停用保存功能。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   也可以直接一个空字符串来实现停用：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   save &quot;&quot;</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">By default Redis will stop accepting writes if RDB snapshots are enabled</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">(at least one save point) and the latest background save failed.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">This will make the user aware (in a hard way) that data is not persisting</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">on disk properly, otherwise chances are that no one will notice and some</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">disaster will happen.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If the background saving process will start working again Redis will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">automatically allow writes again.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># However if you have setup your proper monitoring of the Redis server</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">and persistence, you may want to disable this feature so that Redis will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">continue to work as usual even if there are problems with disk,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">permissions, and so forth.</span></span></span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果用户开启了RDB快照功能，那么在redis持久化数据到磁盘时如果出现失败，默认情况下，redis会停止接受所有的写请求。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 这样做的好处在于可以让用户很明确的知道内存中的数据和磁盘上的数据已经存在不一致了。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果redis不顾这种不一致，一意孤行的继续接收写请求，就可能会引起一些灾难性的后果。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果下一次RDB持久化成功，redis会自动恢复接受写请求。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果不在乎这种数据不一致或者有其他的手段发现和控制这种不一致的话，可以关闭这个功能，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 以便在快照写入失败时，也能确保redis继续接受新的写请求。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Compress string objects using LZF when dump .rdb databases?</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">For default that&#x27;</span>s <span class="built_in">set</span> to <span class="string">&#x27;yes&#x27;</span> as it<span class="string">&#x27;s almost always a win.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If you want to save some CPU in the saving child set it to &#x27;</span>no<span class="string">&#x27; but</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the dataset will likely be bigger if you have compressible values or keys.</span></span></span><br><span class="line">rdbcompression yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 对于存储到磁盘中的快照，可以设置是否进行压缩存储。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果是的话，redis会采用LZF算法进行压缩。如果你不想消耗CPU来进行压缩的话，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 可以设置为关闭此功能，但是存储在磁盘上的快照会比较大。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Since version 5 of RDB a CRC64 checksum is placed at the end of the file.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">This makes the format more resistant to corruption but there is a performance</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">hit to pay (around 10%) when saving and loading RDB files, so you can disable it</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">for maximum performances.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># RDB files created with checksum disabled have a checksum of zero that will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">tell the loading code to skip the check.</span></span></span><br><span class="line">rdbchecksum yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 在存储快照后，我们还可以让redis使用CRC64算法来进行数据校验，但是这样做会增加大约10%的性能消耗，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果希望获取到最大的性能提升，可以关闭此功能。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The filename where to dump the DB</span></span></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">设置快照的文件名</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The working directory.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The DB will be written inside this directory, with the filename specified</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">above using the &#x27;</span>dbfilename<span class="string">&#x27; configuration directive.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The Append Only File will also be created inside this directory.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Note that you must specify a directory here, not a file name.</span></span></span><br><span class="line">dir ./</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 设置快照文件的存放路径，这个配置项一定是个目录，而不能是文件名</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">################################ REPLICATION #################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Master-Replica replication. Use replicaof to make a Redis instance a copy of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">another Redis server. A few things to understand ASAP about Redis replication.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   +------------------+      +---------------+</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  |      Master      | ---&gt; |    Replica    |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  | (receive writes) |      |  (exact copy) |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  +------------------+      +---------------+</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1) Redis replication is asynchronous, but you can configure a master to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   stop accepting writes if it appears to be not connected with at least</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   a given number of replicas.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">2) Redis replicas are able to perform a partial resynchronization with the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   master if the replication link is lost for a relatively small amount of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   time. You may want to configure the replication backlog size (see the next</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   sections of this file) with a sensible value depending on your needs.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">3) Replication is automatic and does not need user intervention. After a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   network partition replicas automatically try to reconnect to masters</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   and resynchronize with them.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># replicaof &lt;masterip&gt; &lt;masterport&gt;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">主从复制，使用replicaof来让一个redis实例成为另一个redis实例的副本，默认关闭</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">注意这个只需要在replica上配置</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">If the master is password protected (using the &quot;requirepass&quot; configuration</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">directive below) it is possible to tell the replica to authenticate before</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">starting the replication synchronization process, otherwise the master will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">refuse the replica request.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># masterauth &lt;master-password&gt;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">如果master需要密码认证，就在这里设置，默认不设置</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">When a replica loses its connection with the master, or when the replication</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">is still in progress, the replica can act in two different ways:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1) if replica-serve-stale-data is set to &#x27;</span><span class="built_in">yes</span><span class="string">&#x27; (the default) the replica will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   still reply to client requests, possibly with out of date data, or the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   data set may just be empty if this is the first synchronization.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 2) if replica-serve-stale-data is set to &#x27;</span>no<span class="string">&#x27; the replica will reply with</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   an error &quot;SYNC with master in progress&quot; to all the kind of commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   but to INFO, replicaOF, AUTH, PING, SHUTDOWN, REPLCONF, ROLE, CONFIG,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   SUBSCRIBE, UNSUBSCRIBE, PSUBSCRIBE, PUNSUBSCRIBE, PUBLISH, PUBSUB,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   COMMAND, POST, HOST: and LATENCY.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">replica-serve-stale-data yes</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">当一个 replica与 master 失去联系，或者复制正在进行的时候，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> replica可能会有两种表现：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 1) 如果为 yes ，replica仍然会应答客户端请求，但返回的数据可能是过时，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">    或者数据可能是空的在第一次同步的时候</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 2)如果copy -serve- stal- data设置为“否”，那么这个副本将会回复</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   在所有命令中出现“与master同步”的错误</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   但是对于INFO, replicaOF, AUTH, PING, SHUTDOWN, REPLCONF, ROLE, CONFIG，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   订阅，取消订阅，PSUBSCRIBE, PUNSUBSCRIBE, PUBLISH, PUBSUB，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   命令，POST, HOST:延时。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">You can configure a replica instance to accept writes or not. Writing against</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">a replica instance may be useful to store some ephemeral data (because data</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">written on a replica will be easily deleted after resync with the master) but</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">may also cause problems if clients are writing to it because of a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">misconfiguration.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Since Redis 2.6 by default replicas are read-only.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Note: read only replicas are not designed to be exposed to untrusted clients</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">on the internet. It&#x27;</span>s just a protection layer against misuse of the instance.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Still a <span class="built_in">read</span> only replica exports by default all the administrative commands</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">such as CONFIG, DEBUG, and so forth. To a limited extent you can improve</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">security of <span class="built_in">read</span> only replicas using <span class="string">&#x27;rename-command&#x27;</span> to shadow all the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">administrative / dangerous commands.</span></span><br><span class="line">replica-read-only yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 你可以配置一个 slave 实体是否接受写入操作。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 通过写入操作来存储一些短暂的数据对于一个 replica实例来说可能是有用的，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 因为相对从 master 重新同步数而言，据数据写入到 replica会更容易被删除。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 但是如果客户端因为一个错误的配置写入，也可能会导致一些问题。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 从 redis 2.6 版起，默认 slaves 都是只读的。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Replication SYNC strategy: disk or socket.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># -------------------------------------------------------</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">WARNING: DISKLESS REPLICATION IS EXPERIMENTAL CURRENTLY</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-------------------------------------------------------</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># New replicas and reconnecting replicas that are not able to continue the replication</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">process just receiving differences, need to <span class="keyword">do</span> what is called a <span class="string">&quot;full</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">synchronization&quot;</span>. An RDB file is transmitted from the master to the replicas.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The transmission can happen <span class="keyword">in</span> two different ways:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 1) Disk-backed: The Redis master creates a new process that writes the RDB</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">                file on disk. Later the file is transferred by the parent</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">                process to the replicas incrementally.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2) Diskless: The Redis master creates a new process that directly writes the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">             RDB file to replica sockets, without touching the disk at all.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># With disk-backed replication, while the RDB file is generated, more replicas</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">can be queued and served with the RDB file as soon as the current child producing</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the RDB file finishes its work. With diskless replication instead once</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the transfer starts, new replicas arriving will be queued and a new transfer</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">will start when the current one terminates.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># When diskless replication is used, the master waits a configurable amount of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">time (<span class="keyword">in</span> seconds) before starting the transfer <span class="keyword">in</span> the hope that multiple replicas</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">will arrive and the transfer can be parallelized.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># With slow disks and fast (large bandwidth) networks, diskless replication</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">works better.</span></span><br><span class="line">repl-diskless-sync no</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 主从数据复制是否使用无硬盘复制功能。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 新的从站和重连后不能继续备份的从站，需要做所谓的“完全备份”，即将一个RDB文件从主站传送到从站。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 这个传送有以下两种方式：</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 1）硬盘备份：redis主站创建一个新的进程，用于把RDB文件写到硬盘上。过一会儿，其父进程递增地将文件传送给从站。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 2）无硬盘备份：redis主站创建一个新的进程，子进程直接把RDB文件写到从站的套接字，不需要用到硬盘。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 在硬盘备份的情况下，主站的子进程生成RDB文件。一旦生成，多个从站可以立即排成队列使用主站的RDB文件。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 在无硬盘备份的情况下，一次RDB传送开始，新的从站到达后，需要等待现在的传送结束，才能开启新的传送。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 如果使用无硬盘备份，主站会在开始传送之间等待一段时间（可配置，以秒为单位），希望等待多个子站到达后并行传送。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 在硬盘低速而网络高速（高带宽）情况下，无硬盘备份更好。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">When diskless replication is enabled, it is possible to configure the delay</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the server waits <span class="keyword">in</span> order to spawn the child that transfers the RDB via socket</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to the replicas.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This is important since once the transfer starts, it is not possible to serve</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">new replicas arriving, that will be queued <span class="keyword">for</span> the next RDB transfer, so the server</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">waits a delay <span class="keyword">in</span> order to <span class="built_in">let</span> more replicas arrive.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The delay is specified in seconds, and by default is 5 seconds. To disable</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">it entirely just <span class="built_in">set</span> it to 0 seconds and the transfer will start ASAP.</span></span><br><span class="line">repl-diskless-sync-delay 5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 当启用无硬盘备份，服务器等待一段时间后才会通过套接字向从站传送RDB文件，这个等待时间是可配置的。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 这一点很重要，因为一旦传送开始，就不可能再为一个新到达的从站服务。从站则要排队等待下一次RDB传送。因此服务器等待一段</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 时间以期更多的从站到达。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 延迟时间以秒为单位，默认为5秒。要关掉这一功能，只需将它设置为0秒，传送会立即启动。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Replicas send PINGs to server <span class="keyword">in</span> a predefined interval. It<span class="string">&#x27;s possible to change</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">this interval with the repl_ping_replica_period option. The default value is 10</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">seconds.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># repl-ping-replica-period 10</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">从redis会周期性的向主redis发出PING包，你可以通过repl_ping_slave_period指令来控制其周期，默认是10秒。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The following option sets the replication timeout for:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1) Bulk transfer I/O during SYNC, from the point of view of replica.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">2) Master timeout from the point of view of replicas (data, pings).</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">3) Replica timeout from the point of view of masters (REPLCONF ACK pings).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># It is important to make sure that this value is greater than the value</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">specified for repl-ping-replica-period otherwise a timeout will be detected</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">every time there is low traffic between the master and the replica.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># repl-timeout 60</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">接下来的选项为以下内容设置备份的超时时间：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 1）从从站的角度，同步期间的批量传输的I/O</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 2）从站角度认为的主站超时（数据，ping）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 3）主站角度认为的从站超时（REPLCONF ACK pings)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 确认这些值比定义的repl-ping-slave-period要大，否则每次主站和从站之间通信低速时都会被检测为超时。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Disable TCP_NODELAY on the replica socket after SYNC?</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If you select &quot;yes&quot; Redis will use a smaller number of TCP packets and</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">less bandwidth to send data to replicas. But this can add a delay for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the data to appear on the replica side, up to 40 milliseconds with</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Linux kernels using a default configuration.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If you select &quot;no&quot; the delay for data to appear on the replica side will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">be reduced but more bandwidth will be used for replication.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># By default we optimize for low latency, but in very high traffic conditions</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">or when the master and replicas are many hops away, turning this to &quot;yes&quot; may</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">be a good idea.</span></span></span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 同步之后是否禁用从站上的TCP_NODELAY</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果你选择yes，redis会使用较少量的TCP包和带宽向从站发送数据。但这会导致在从站增加一点数据的延时。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> Linux内核默认配置情况下最多40毫秒的延时。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果选择no，从站的数据延时不会那么多，但备份需要的带宽相对较多。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 默认情况下我们将潜在因素优化，但在高负载情况下或者在主从站都跳的情况下，把它切换为yes是个好主意。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Set the replication backlog size. The backlog is a buffer that accumulates</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">replica data when replicas are disconnected for some time, so that when a replica</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">wants to reconnect again, often a full resync is not needed, but a partial</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">resync is enough, just passing the portion of data the replica missed while</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">disconnected.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The bigger the replication backlog, the longer the time the replica can be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">disconnected and later be able to perform a partial resynchronization.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The backlog is only allocated once there is at least a replica connected.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># repl-backlog-size 1mb</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 设置备份的工作储备大小。工作储备是一个缓冲区，当从站断开一段时间的情况时，它替从站接收存储数据，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 因此当从站重连时，通常不需要完全备份，只需要一个部分同步就可以，即把从站断开时错过的一部分数据接收。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 工作储备越大，从站可以断开并稍后执行部分同步的断开时间就越长。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 只要有一个从站连接，就会立刻分配一个工作储备。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">After a master has no longer connected replicas for some time, the backlog</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">will be freed. The following option configures the amount of seconds that</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">need to elapse, starting from the time the last replica disconnected, for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the backlog buffer to be freed.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Note that replicas never free the backlog for timeout, since they may be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">promoted to masters later, and should be able to correctly &quot;partially</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">resynchronize&quot; with the replicas: hence they should always accumulate backlog.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># A value of 0 means to never release the backlog.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># repl-backlog-ttl 3600</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 主站有一段时间没有与从站连接，对应的工作储备就会自动释放。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 这个选项用于配置释放前等待的秒数，秒数从断开的那一刻开始计算，值为0表示不释放。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The replica priority is an integer number published by Redis in the INFO output.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">It is used by Redis Sentinel in order to select a replica to promote into a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">master if the master is no longer working correctly.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># A replica with a low priority number is considered better for promotion, so</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">for instance if there are three replicas with priority 10, 100, 25 Sentinel will</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">pick the one with priority 10, that is the lowest.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># However a special priority of 0 marks the replica as not able to perform the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">role of master, so a replica with priority of 0 will never be selected by</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis Sentinel for promotion.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># By default the priority is 100.</span></span></span><br><span class="line">replica-priority 100</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 从站优先级是可以从redis的INFO命令输出中查到的一个整数。当主站不能正常工作时</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> redis sentinel使用它来选择一个从站并将它提升为主站。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 低优先级的从站被认为更适合于提升，因此如果有三个从站优先级分别是10，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 100，25，sentinel会选择优先级为10的从站，因为它的优先级最低。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 然而优先级值为0的从站不能执行主站的角色，因此优先级为0的从站永远不会被redis sentinel提升。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 默认优先级是100</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">It is possible for a master to stop accepting writes if there are less than</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">N replicas connected, having a lag less or equal than M seconds.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The N replicas need to be in &quot;online&quot; state.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The lag in seconds, that must be &lt;= the specified value, is calculated from</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the last ping received from the replica, that is usually sent every second.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># This option does not GUARANTEE that N replicas will accept the write, but</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">will limit the window of exposure for lost writes in case not enough replicas</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">are available, to the specified number of seconds.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># For example to require at least 3 replicas with a lag &lt;= 10 seconds use:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># min-replicas-to-write 3</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">min-replicas-max-lag 10</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 主站可以停止接受写请求，当与它连接的从站少于N个，滞后少于M秒，N个从站必须是在线状态。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 延迟的秒数必须&lt;=所定义的值，延迟秒数是从最后一次收到的来自从站的ping开始计算。ping通常是每秒一次。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 这一选项并不保证N个备份都会接受写请求，但是会限制在指定秒数内由于从站数量不够导致的写操作丢失的情况。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果想要至少3个从站且延迟少于10秒，如上配置即可</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Setting one or the other to 0 disables the feature.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># By default min-replicas-to-write is set to 0 (feature disabled) and</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">min-replicas-max-lag is set to 10.</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">A Redis master is able to list the address and port of the attached</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">replicas in different ways. For example the &quot;INFO replication&quot; section</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">offers this information, which is used, among other tools, by</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis Sentinel in order to discover replica instances.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Another place where this info is available is in the output of the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;ROLE&quot; command of a master.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The listed IP and address normally reported by a replica is obtained</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in the following way:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   IP: The address is auto detected by checking the peer address</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  of the socket used by the replica to connect with the master.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   Port: The port is communicated by the replica during the replication</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  handshake, and is normally the port that the replica is using to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  listen for connections.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># However when port forwarding or Network Address Translation (NAT) is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">used, the replica may be actually reachable via different IP and port</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">pairs. The following two options can be used by a replica in order to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">report to its master a specific set of IP and port, so that both INFO</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">and ROLE will report those values.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># There is no need to use both the options if you need to override just</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the port or the IP address.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># replica-announce-ip 5.5.5.5</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">replica-announce-port 1234</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis master能够以不同的方式列出所连接slave的地址和端口。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">例如，“INFO replication”部分提供此信息，除了其他工具之外，Redis Sentinel还使用该信息来发现slave实例。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">此信息可用的另一个地方在masterser的“ROLE”命令的输出中。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">通常由slave报告的列出的IP和地址,通过以下方式获得：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">IP：通过检查slave与master连接使用的套接字的对等体地址自动检测地址。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">端口：端口在复制握手期间由slavet通信，并且通常是slave正在使用列出连接的端口。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">然而，当使用端口转发或网络地址转换（NAT）时，slave实际上可以通过(不同的IP和端口对)来到达。 slave可以使用以下两个选项，以便向master报告一组特定的IP和端口，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">以便INFO和ROLE将报告这些值。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">如果你需要仅覆盖端口或IP地址，则没必要使用这两个选项。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">################################# SECURITY ###################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Require clients to issue AUTH &lt;PASSWORD&gt; before processing any other</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">commands.  This might be useful in environments in which you do not trust</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">others with access to the host running redis-server.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># This should stay commented out for backward compatibility and because most</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">people do not need auth (e.g. they run their own servers).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Warning: since Redis is pretty fast an outside user can try up to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">150k passwords per second against a good box. This means that you should</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">use a very strong password otherwise it will be very easy to break.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># requirepass foobared</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">设置Redis连接密码</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Command renaming.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># It is possible to change the name of dangerous commands in a shared</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">environment. For instance the CONFIG command may be renamed into something</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">hard to guess so that it will still be available for internal-use tools</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">but not available for general clients.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Example:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># It is also possible to completely kill a command by renaming it into</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">an empty string:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># rename-command CONFIG &quot;&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 将命令重命名，为了安全考虑，可以将某些重要的、危险的命令重命名。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 当你把某个命令重命名成空字符串的时候就等于取消了这个命令。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Please note that changing the name of commands that are logged into the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">AOF file or transmitted to replicas may cause problems.</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">################################## CLIENTS ####################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Set the max number of connected clients at the same time. By default</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">this limit is set to 10000 clients, however if the Redis server is not</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">able to configure the process file limit to allow for the specified limit</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the max number of allowed clients is set to the current file limit</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">minus 32 (as Redis reserves a few file descriptors for internal uses).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Once the limit is reached Redis will close all the new connections sending</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">an error &#x27;</span>max number of clients reached<span class="string">&#x27;.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># maxclients 10000</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 设置客户端最大并发连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 描述符数-32（redis server自身会使用一些），如果设置 maxclients为0</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">############################# MEMORY MANAGEMENT ################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Set a memory usage limit to the specified amount of bytes.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">When the memory limit is reached Redis will try to remove keys</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">according to the eviction policy selected (see maxmemory-policy).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If Redis can&#x27;</span>t remove keys according to the policy, or <span class="keyword">if</span> the policy is</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> to <span class="string">&#x27;noeviction&#x27;</span>, Redis will start to reply with errors to commands</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">that would use more memory, like SET, LPUSH, and so on, and will <span class="built_in">continue</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to reply to read-only commands like GET.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This option is usually useful when using Redis as an LRU or LFU cache, or to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> a hard memory <span class="built_in">limit</span> <span class="keyword">for</span> an instance (using the <span class="string">&#x27;noeviction&#x27;</span> policy).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># WARNING: If you have replicas attached to an instance with maxmemory on,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the size of the output buffers needed to feed the replicas are subtracted</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">from the used memory count, so that network problems / resyncs will</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">not trigger a loop <span class="built_in">where</span> keys are evicted, and <span class="keyword">in</span> turn the output</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">buffer of replicas is full with DELs of keys evicted triggering the deletion</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">of more keys, and so forth <span class="keyword">until</span> the database is completely emptied.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># In short... if you have replicas attached it is suggested that you set a lower</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">limit</span> <span class="keyword">for</span> maxmemory so that there is some free RAM on the system <span class="keyword">for</span> replica</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">output buffers (but this is not needed <span class="keyword">if</span> the policy is <span class="string">&#x27;noeviction&#x27;</span>).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># maxmemory &lt;bytes&gt;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 会把Key存放内存，Value会存放在swap区，格式：maxmemory &lt;bytes&gt;</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">MAXMEMORY POLICY: how Redis will <span class="keyword">select</span> what to remove when maxmemory</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">is reached. You can <span class="keyword">select</span> among five behaviors:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># volatile-lru -&gt; Evict using approximated LRU among the keys with an expire set.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">allkeys-lru -&gt; Evict any key using approximated LRU.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">volatile-lfu -&gt; Evict using approximated LFU among the keys with an expire <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">allkeys-lfu -&gt; Evict any key using approximated LFU.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">volatile-random -&gt; Remove a random key among the ones with an expire <span class="built_in">set</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">allkeys-random -&gt; Remove a random key, any key.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">volatile-ttl -&gt; Remove the key with the nearest expire time (minor TTL)</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">noeviction -&gt; Don<span class="string">&#x27;t evict anything, just return an error on write operations.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># LRU means Least Recently Used</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">LFU means Least Frequently Used</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Both LRU, LFU and volatile-ttl are implemented using approximated</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">randomized algorithms.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Note: with any of the above policies, Redis will return an error on write</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">      operations, when there are no suitable keys for eviction.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#       At the date of writing these commands are: set setnx setex append</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">      incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">      sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">      zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">      getset mset msetnx exec sort</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The default is:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># maxmemory-policy noeviction</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 当内存使用达到最大值时，redis使用的清楚策略。有以下几种可以选择：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 1）volatile-lru   利用LRU算法移除设置过过期时间的key (LRU:最近使用 Least Recently Used )</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 2）allkeys-lru   利用LRU算法移除任何key</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 3）volatile-random 移除设置过过期时间的随机key</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 4）allkeys-random  移除随机ke</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 5）volatile-ttl   移除即将过期的key(minor TTL)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 6）noeviction  noeviction   不移除任何key，只是返回一个写错误 ，默认选项</span></span></span><br><span class="line">maxmemory-policy volatile-lfu</span><br><span class="line">maxmemory-policy allkeys-lfu</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">LRU, LFU and minimal TTL algorithms are not precise algorithms but approximated</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">algorithms (in order to save memory), so you can tune it for speed or</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">accuracy. For default Redis will check five keys and pick the one that was</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">used less recently, you can change the sample size using the following</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">configuration directive.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The default of 5 produces good enough results. 10 Approximates very closely</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">true LRU but costs more CPU. 3 is faster but not very accurate.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># maxmemory-samples 5</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> LRU 和 minimal TTL 算法都不是精准的算法，但是相对精确的算法(为了节省内存)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 随意你可以选择样本大小进行检，redis默认选择3个样本进行检测，你可以通过maxmemory-samples进行设置样本数</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Starting from Redis 5, by default a replica will ignore its maxmemory setting</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">(unless it is promoted to master after a failover or manually). It means</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">that the eviction of keys will be just handled by the master, sending the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">DEL commands to the replica as keys evict in the master side.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># This behavior ensures that masters and replicas stay consistent, and is usually</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">what you want, however if your replica is writable, or you want the replica to have</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">a different memory setting, and you are sure all the writes performed to the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">replica are idempotent, then you may change this default (but be sure to understand</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">what you are doing).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Note that since the replica by default does not evict, it may end using more</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">memory than the one set via maxmemory (there are certain buffers that may</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">be larger on the replica, or data structures may sometimes take more memory and so</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">forth). So make sure you monitor your replicas and make sure they have enough</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">memory to never hit a real out-of-memory condition before the master hits</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the configured maxmemory setting.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># replica-ignore-maxmemory yes</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">############################ LAZY FREEING ####################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis has two primitives to delete keys. One is called DEL and is a blocking</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">deletion of the object. It means that the server stops processing new commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in order to reclaim all the memory associated with an object in a synchronous</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">way. If the key deleted is associated with a small object, the time needed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in order to execute the DEL command is very small and comparable to most other</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">O(1) or O(log_N) commands in Redis. However if the key is associated with an</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">aggregated value containing millions of elements, the server can block for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">a long time (even seconds) in order to complete the operation.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># For the above reasons Redis also offers non blocking deletion primitives</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">such as UNLINK (non blocking DEL) and the ASYNC option of FLUSHALL and</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">FLUSHDB commands, in order to reclaim memory in background. Those commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">are executed in constant time. Another thread will incrementally free the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">object in the background as fast as possible.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># DEL, UNLINK and ASYNC option of FLUSHALL and FLUSHDB are user-controlled.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">It&#x27;</span>s up to the design of the application to understand when it is a good</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">idea to use one or the other. However the Redis server sometimes has to</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">delete keys or flush the whole database as a side effect of other operations.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Specifically Redis deletes objects independently of a user call <span class="keyword">in</span> the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">following scenarios:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 1) On eviction, because of the maxmemory and maxmemory policy configurations,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   <span class="keyword">in</span> order to make room <span class="keyword">for</span> new data, without going over the specified</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   memory <span class="built_in">limit</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2) Because of expire: when a key with an associated time to live (see the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   EXPIRE <span class="built_in">command</span>) must be deleted from memory.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">3) Because of a side effect of a <span class="built_in">command</span> that stores data on a key that may</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   already exist. For example the RENAME <span class="built_in">command</span> may delete the old key</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   content when it is replaced with another one. Similarly SUNIONSTORE</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   or SORT with STORE option may delete existing keys. The SET <span class="built_in">command</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   itself removes any old content of the specified key <span class="keyword">in</span> order to replace</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   it with the specified string.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">4) During replication, when a replica performs a full resynchronization with</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   its master, the content of the whole database is removed <span class="keyword">in</span> order to</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   load the RDB file just transferred.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># In all the above cases the default is to delete objects in a blocking way,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">like <span class="keyword">if</span> DEL was called. However you can configure each <span class="keyword">case</span> specifically</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> order to instead release memory <span class="keyword">in</span> a non-blocking way like <span class="keyword">if</span> UNLINK</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">was called, using the following configuration directives:</span></span><br><span class="line"> </span><br><span class="line">lazyfree-lazy-eviction no</span><br><span class="line">lazyfree-lazy-expire no</span><br><span class="line">lazyfree-lazy-server-del no</span><br><span class="line">replica-lazy-flush no</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">############################# APPEND ONLY MODE ###############################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">By default Redis asynchronously dumps the dataset on disk. This mode is</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">good enough <span class="keyword">in</span> many applications, but an issue with the Redis process or</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">a power outage may result into a few minutes of writes lost (depending on</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the configured save points).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The Append Only File is an alternative persistence mode that provides</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">much better durability. For instance using the default data fsync policy</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(see later <span class="keyword">in</span> the config file) Redis can lose just one second of writes <span class="keyword">in</span> a</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">dramatic event like a server power outage, or a single write <span class="keyword">if</span> something</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">wrong with the Redis process itself happens, but the operating system is</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">still running correctly.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># AOF and RDB persistence can be enabled at the same time without problems.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">If the AOF is enabled on startup Redis will load the AOF, that is the file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">with the better durability guarantees.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Please check http://redis.io/topics/persistence for more information.</span></span></span><br><span class="line"> </span><br><span class="line">appendonly no</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用了。但是redis如果中途宕机，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 会导致可能有几分钟的数据丢失，根据save来策略进行持久化，Append Only File是另一种持久化方式，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 可以提供更好的持久化特性。Redis会把每次写入的数据在接收后都写入appendonly.aof文件，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The name of the append only file (default: <span class="string">&quot;appendonly.aof&quot;</span>)</span></span><br><span class="line"> </span><br><span class="line">appendfilename &quot;appendonly.aof&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">aof文件名</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The fsync() call tells the Operating System to actually write data on disk</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">instead of waiting <span class="keyword">for</span> more data <span class="keyword">in</span> the output buffer. Some OS will really flush</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">data on disk, some other OS will just try to <span class="keyword">do</span> it ASAP.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Redis supports three different modes:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># no: don&#x27;t fsync, just let the OS flush the data when it wants. Faster.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">always: fsync after every write to the append only <span class="built_in">log</span>. Slow, Safest.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">everysec: fsync only one time every second. Compromise.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The default is &quot;everysec&quot;, as that&#x27;s usually the right compromise between</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">speed and data safety. It<span class="string">&#x27;s up to you to understand if you can relax this to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;no&quot; that will let the operating system flush the output buffer when</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">it wants, for better performances (but if you can live with the idea of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">some data loss consider the default persistence mode that&#x27;</span>s snapshotting),</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">or on the contrary, use <span class="string">&quot;always&quot;</span> that<span class="string">&#x27;s very slow but a bit safer than</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">everysec.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># More details please check the following article:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">http://antirez.com/post/redis-persistence-demystified.html</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If unsure, use &quot;everysec&quot;.</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">appendfsync always</span></span></span><br><span class="line">appendfsync everysec</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">appendfsync no</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> aof持久化策略的配置</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> no表示不执行fsync，由操作系统保证数据同步到磁盘，速度最快。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> always表示每次写入都执行fsync，以保证数据同步到磁盘。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> everysec表示每秒执行一次fsync，可能会导致丢失这1s数据</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">When the AOF fsync policy is set to always or everysec, and a background</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">saving process (a background save or AOF log background rewriting) is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">performing a lot of I/O against the disk, in some Linux configurations</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis may block too long on the fsync() call. Note that there is no fix for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">this currently, as even performing fsync in a different thread will block</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">our synchronous write(2) call.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># In order to mitigate this problem it&#x27;</span>s possible to use the following option</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">that will prevent fsync() from being called <span class="keyword">in</span> the main process <span class="keyword">while</span> a</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">BGSAVE or BGREWRITEAOF is <span class="keyword">in</span> progress.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This means that while another child is saving, the durability of Redis is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the same as <span class="string">&quot;appendfsync none&quot;</span>. In practical terms, this means that it is</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">possible to lose up to 30 seconds of <span class="built_in">log</span> <span class="keyword">in</span> the worst scenario (with the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">default Linux settings).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># If you have latency problems turn this to &quot;yes&quot;. Otherwise leave it as</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;no&quot;</span> that is the safest pick from the point of view of durability.</span></span><br><span class="line"> </span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  在aof重写或者写入rdb文件的时候，会执行大量IO，此时对于everysec和always的aof模式来说，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  执行fsync会造成阻塞过长时间，no-appendfsync-on-rewrite字段设置为默认设置为no。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  如果对延迟要求很高的应用，这个字段可以设置为<span class="built_in">yes</span>，否则还是设置为no，这样对持久化特性来说这是更安全的选择。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  设置为<span class="built_in">yes</span>表示rewrite期间对新写操作不fsync,暂时存在内存中,等rewrite完成后再写入，默认为no，建议<span class="built_in">yes</span>。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">  Linux的默认fsync策略是30秒。可能丢失30秒数据。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Automatic rewrite of the append only file.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Redis is able to automatically rewrite the <span class="built_in">log</span> file implicitly calling</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">BGREWRITEAOF when the AOF <span class="built_in">log</span> size grows by the specified percentage.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This is how it works: Redis remembers the size of the AOF file after the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">latest rewrite (<span class="keyword">if</span> no rewrite has happened since the restart, the size of</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the AOF at startup is used).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This base size is compared to the current size. If the current size is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bigger than the specified percentage, the rewrite is triggered. Also</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">you need to specify a minimal size <span class="keyword">for</span> the AOF file to be rewritten, this</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">is useful to avoid rewriting the AOF file even <span class="keyword">if</span> the percentage increase</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">is reached but it is still pretty small.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Specify a percentage of zero in order to disable the automatic AOF</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rewrite feature.</span></span><br><span class="line"> </span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> aof自动重写配置，当目前aof文件大小超过上一次重写的aof文件大小的百分之多少进行重写，</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 即当aof文件增长到一定大小的时候，Redis能够调用bgrewriteaof对日志文件进行重写。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 当前AOF文件大小是上次日志重写得到AOF文件大小的二倍（设置为100）时，自动启动新的日志重写过程。</span></span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line">设置允许重写的最小aof文件大小，避免了达到约定百分比但尺寸仍然很小的情况还要重写</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">An AOF file may be found to be truncated at the end during the Redis</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">startup process, when the AOF data gets loaded back into memory.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This may happen when the system <span class="built_in">where</span> Redis is running</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">crashes, especially when an ext4 filesystem is mounted without the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">data=ordered option (however this can<span class="string">&#x27;t happen when Redis itself</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">crashes or aborts but the operating system still works correctly).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Redis can either exit with an error when this happens, or load as much</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">data as possible (the default now) and start if the AOF file is found</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">to be truncated at the end. The following option controls this behavior.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If aof-load-truncated is set to yes, a truncated AOF file is loaded and</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the Redis server starts emitting a log to inform the user of the event.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Otherwise if the option is set to no, the server aborts with an error</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">and refuses to start. When the option is set to no, the user requires</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">to fix the AOF file using the &quot;redis-check-aof&quot; utility before to restart</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the server.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Note that if the AOF file will be found to be corrupted in the middle</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the server will still exit with an error. This option only applies when</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis will try to read more data from the AOF file but not enough bytes</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">will be found.</span></span></span><br><span class="line">aof-load-truncated yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> aof文件可能在尾部是不完整的，当redis启动的时候，aof文件的数据被载入内存。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 重启可能发生在redis所在的主机操作系统宕机后，尤其在ext4文件系统没有加上data=ordered选项，出现这种现象</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> redis宕机或者异常终止不会造成尾部不完整现象，可以选择让redis退出，或者导入尽可能多的数据。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果选择的是yes，当截断的aof文件被导入的时候，会自动发布一个log给客户端然后load。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果是no，用户必须手动redis-check-aof修复AOF文件才可以。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">When rewriting the AOF file, Redis is able to use an RDB preamble in the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">AOF file for faster rewrites and recoveries. When this option is turned</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">on the rewritten AOF file is composed of two different stanzas:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   [RDB file][AOF tail]</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># When loading Redis recognizes that the AOF file starts with the &quot;REDIS&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">string and loads the prefixed RDB file, and continues loading the AOF</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">tail.</span></span></span><br><span class="line">aof-use-rdb-preamble yes</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">############################### LUA SCRIPTING  ###############################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Max execution time of a Lua script in milliseconds.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If the maximum execution time is reached Redis will log that a script is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">still in execution after the maximum allowed time and will start to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">reply to queries with an error.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># When a long running script exceeds the maximum execution time only the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">SCRIPT KILL and SHUTDOWN NOSAVE commands are available. The first can be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">used to stop a script that did not yet called write commands. The second</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">is the only way to shut down the server in the case a write command was</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">already issued by the script but the user doesn&#x27;</span>t want to <span class="built_in">wait</span> <span class="keyword">for</span> the natural</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">termination of the script.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Set it to 0 or a negative value for unlimited execution without warnings.</span></span></span><br><span class="line">lua-time-limit 5000</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 如果达到最大时间限制（毫秒），redis会记个<span class="built_in">log</span>，然后返回error。当一个脚本超过了最大时限。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 只有SCRIPT KILL和SHUTDOWN NOSAVE可以用。第一个可以杀没有调write命令的东西。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 要是已经调用了write，只能用第二个命令杀</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">############################### REDIS CLUSTER  ###############################</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">WARNING EXPERIMENTAL: Redis Cluster is considered to be stable code, however</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> order to mark it as <span class="string">&quot;mature&quot;</span> we need to <span class="built_in">wait</span> <span class="keyword">for</span> a non trivial percentage</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">of <span class="built_in">users</span> to deploy it <span class="keyword">in</span> production.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Normal Redis instances can&#x27;t be part of a Redis Cluster; only nodes that are</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">started as cluster nodes can. In order to start a Redis instance as a</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cluster node <span class="built_in">enable</span> the cluster support uncommenting the following:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-enabled yes</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">集群开关，默认是不开启集群模式</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Every cluster node has a cluster configuration file. This file is not</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">intended to be edited by hand. It is created and updated by Redis nodes.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Every Redis Cluster node requires a different cluster configuration file.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Make sure that instances running <span class="keyword">in</span> the same system <span class="keyword">do</span> not have</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">overlapping cluster configuration file names.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-config-file nodes-6379.conf</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">集群配置文件的名称，每个节点都有一个集群相关的配置文件，持久化保存集群的信息。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个文件并不需要手动配置，这个配置文件有Redis生成并更新，每个Redis集群节点需要一个单独的配置文件</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">请确保与实例运行的系统中配置文件名称不冲突</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cluster node <span class="built_in">timeout</span> is the amount of milliseconds a node must be unreachable</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> it to be considered <span class="keyword">in</span> failure state.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Most other internal time limits are multiple of the node <span class="built_in">timeout</span>.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-node-timeout 15000</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">节点互连超时的阀值，集群节点超时毫秒数</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">A replica of a failing master will avoid to start a failover <span class="keyword">if</span> its data</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">looks too old.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># There is no simple way for a replica to actually have an exact measure of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">its <span class="string">&quot;data age&quot;</span>, so the following two checks are performed:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 1) If there are multiple replicas able to failover, they exchange messages</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   <span class="keyword">in</span> order to try to give an advantage to the replica with the best</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   replication offset (more data from the master processed).</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   Replicas will try to get their rank by offset, and apply to the start</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   of the failover a delay proportional to their rank.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 2) Every single replica computes the time of the last interaction with</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   its master. This can be the last ping or <span class="built_in">command</span> received (<span class="keyword">if</span> the master</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   is still <span class="keyword">in</span> the <span class="string">&quot;connected&quot;</span> state), or the time that elapsed since the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   disconnection with the master (<span class="keyword">if</span> the replication <span class="built_in">link</span> is currently down).</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   If the last interaction is too old, the replica will not try to failover</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   at all.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The point &quot;2&quot; can be tuned by user. Specifically a replica will not perform</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">the failover <span class="keyword">if</span>, since the last interaction with the master, the time</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">elapsed is greater than:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment">#   (node-timeout * replica-validity-factor) + repl-ping-replica-period</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># So for example if node-timeout is 30 seconds, and the replica-validity-factor</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">is 10, and assuming a default repl-ping-replica-period of 10 seconds, the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">replica will not try to failover <span class="keyword">if</span> it was not able to talk with the master</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> longer than 310 seconds.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># A large replica-validity-factor may allow replicas with too old data to failover</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">a master, <span class="keyword">while</span> a too small value may prevent the cluster from being able to</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">elect a replica at all.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># For maximum availability, it is possible to set the replica-validity-factor</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to a value of 0, <span class="built_in">which</span> means, that replicas will always try to failover the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master regardless of the last time they interacted with the master.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">(However they<span class="string">&#x27;ll always try to apply a delay proportional to their</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">offset rank).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Zero is the only value able to guarantee that when all the partitions heal</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the cluster will always be able to continue.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># cluster-replica-validity-factor 10</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">在进行故障转移的时候，全部slave都会请求申请为master，但是有些slave可能与master断开连接一段时间了，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 导致数据过于陈旧，这样的slave不应该被提升为master。该参数就是用来判断slave节点与master断线的时间是否过长。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 判断方法是：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">    比较slave断开连接的时间和(node-timeout * slave-validity-factor) + repl-ping-slave-period</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">    如果节点超时时间为三十秒, 并且slave-validity-factor为10,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">    假设默认的repl-ping-slave-period是10秒，即如果超过310秒slave将不会尝试进行故障转移</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Cluster replicas are able to migrate to orphaned masters, that are masters</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">that are left without working replicas. This improves the cluster ability</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">to resist to failures as otherwise an orphaned master can&#x27;</span>t be failed over</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> <span class="keyword">case</span> of failure <span class="keyword">if</span> it has no working replicas.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Replicas migrate to orphaned masters only if there are still at least a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">given number of other working replicas <span class="keyword">for</span> their old master. This number</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">is the <span class="string">&quot;migration barrier&quot;</span>. A migration barrier of 1 means that a replica</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">will migrate only <span class="keyword">if</span> there is at least 1 other working replica <span class="keyword">for</span> its master</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">and so forth. It usually reflects the number of replicas you want <span class="keyword">for</span> every</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master <span class="keyword">in</span> your cluster.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Default is 1 (replicas migrate only if their masters remain with at least</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">one replica). To <span class="built_in">disable</span> migration just <span class="built_in">set</span> it to a very large value.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">A value of 0 can be <span class="built_in">set</span> but is useful only <span class="keyword">for</span> debugging and dangerous</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> production.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-migration-barrier 1</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">master的slave数量大于该值，slave才能迁移到其他孤立master上，如果这个参数设为2，</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">那么只有当一个主节点拥有2个可以工作的从节点时，它的一个从节点会尝试迁移。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">By default Redis Cluster nodes stop accepting queries <span class="keyword">if</span> they detect there</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">is at least an <span class="built_in">hash</span> slot uncovered (no available node is serving it).</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This way <span class="keyword">if</span> the cluster is partially down (<span class="keyword">for</span> example a range of <span class="built_in">hash</span> slots</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">are no longer covered) all the cluster becomes, eventually, unavailable.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">It automatically returns available as soon as all the slots are covered again.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># However sometimes you want the subset of the cluster which is working,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to <span class="built_in">continue</span> to accept queries <span class="keyword">for</span> the part of the key space that is still</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">covered. In order to <span class="keyword">do</span> so, just <span class="built_in">set</span> the cluster-require-full-coverage</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">option to no.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-require-full-coverage yes</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 默认情况下，集群全部的slot有节点负责，集群状态才为ok，才能提供服务。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 设置为no，可以在slot没有全部分配的时候提供服务。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> 不建议打开该配置，这样会造成分区的时候，小分区的master一直在接受写请求，而造成很长时间数据不一致</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">This option, when <span class="built_in">set</span> to <span class="built_in">yes</span>, prevents replicas from trying to failover its</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">master during master failures. However the master can still perform a</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">manual failover, <span class="keyword">if</span> forced to <span class="keyword">do</span> so.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># This is useful in different scenarios, especially in the case of multiple</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">data center operations, <span class="built_in">where</span> we want one side to never be promoted <span class="keyword">if</span> not</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">in</span> the <span class="keyword">case</span> of a total DC failure.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-replica-no-failover no</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">In order to setup your cluster make sure to <span class="built_in">read</span> the documentation</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">available at http://redis.io web site.</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######################### CLUSTER DOCKER/NAT support  ########################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">In certain deployments, Redis Cluster nodes address discovery fails, because</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">addresses are NAT-ted or because ports are forwarded (the typical <span class="keyword">case</span> is</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Docker and other containers).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># In order to make Redis Cluster working in such environments, a static</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">configuration <span class="built_in">where</span> each node knows its public address is needed. The</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">following two options are used <span class="keyword">for</span> this scope, and are:</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># * cluster-announce-ip</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">* cluster-announce-port</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">* cluster-announce-bus-port</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Each instruct the node about its address, client port, and cluster message</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">bus port. The information is <span class="keyword">then</span> published <span class="keyword">in</span> the header of the bus packets</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">so that other nodes will be able to correctly map the address of the node</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">publishing the information.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># If the above options are not used, the normal Redis Cluster auto-detection</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">will be used instead.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Note that when remapped, the bus port may not be at the fixed offset of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">clients port + 10000, so you can specify any port and bus-port depending</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">on how they get remapped. If the bus-port is not <span class="built_in">set</span>, a fixed offset of</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">10000 will be used as usually.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Example:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># cluster-announce-ip 10.1.1.5</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cluster-announce-port 6379</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cluster-announce-bus-port 6380</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">################################# SLOW LOG ###################################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The Redis Slow Log is a system to <span class="built_in">log</span> queries that exceeded a specified</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">execution time. The execution time does not include the I/O operations</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">like talking with the client, sending the reply and so forth,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">but just the time needed to actually execute the <span class="built_in">command</span> (this is the only</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">stage of <span class="built_in">command</span> execution <span class="built_in">where</span> the thread is blocked and can not serve</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">other requests <span class="keyword">in</span> the meantime).</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># You can configure the slow log with two parameters: one tells Redis</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">what is the execution time, <span class="keyword">in</span> microseconds, to exceed <span class="keyword">in</span> order <span class="keyword">for</span> the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">command</span> to get logged, and the other parameter is the length of the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">slow <span class="built_in">log</span>. When a new <span class="built_in">command</span> is logged the oldest one is removed from the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">queue of logged commands.</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The following time is expressed <span class="keyword">in</span> microseconds, so 1000000 is equivalent</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to one second. Note that a negative number disables the slow <span class="built_in">log</span>, <span class="keyword">while</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">a value of zero forces the logging of every <span class="built_in">command</span>.</span></span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">slog <span class="built_in">log</span>是用来记录redis运行中执行比较慢的命令耗时。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当命令的执行超过了指定时间，就记录在slow <span class="built_in">log</span>中，slog <span class="built_in">log</span>保存在内存中，所以没有IO操作。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行时间比slowlog-log-slower-than大的请求记录到slowlog里面，单位是微秒，所以1000000就是1秒。</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">注意，负数时间会禁用慢查询日志，而0则会强制记录所有命令。</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">There is no <span class="built_in">limit</span> to this length. Just be aware that it will consume memory.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">You can reclaim memory used by the slow <span class="built_in">log</span> with SLOWLOG RESET.</span></span><br><span class="line">slowlog-max-len 128</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">慢查询长度。当一个新的命令被写进日志的时候，最老的那个记录会被删掉，这个长度没有限制。</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">只要有足够的内存就行，你可以通过SLOWLOG RESET来释放内存</span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">############################### LATENCY MONITOR ##############################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">The Redis latency monitoring subsystem samples different operations</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">at runtime <span class="keyword">in</span> order to collect data related to possible sources of</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">latency of a Redis instance.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># Via the LATENCY command this information is available to the user that can</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">print</span> graphs and obtain reports.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># The system only logs operations that were performed in a time equal or</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">greater than the amount of milliseconds specified via the</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">latency-monitor-threshold configuration directive. When its value is <span class="built_in">set</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">to zero, the latency monitor is turned off.</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># By default latency monitoring is disabled since it is mostly not needed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">if</span> you don<span class="string">&#x27;t have latency issues, and collecting data has a performance</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">impact, that while very small, can be measured under big load. Latency</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">monitoring can easily be enabled at runtime using the command</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">&quot;CONFIG SET latency-monitor-threshold &lt;milliseconds&gt;&quot; if needed.</span></span></span><br><span class="line">latency-monitor-threshold 0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 延迟监控功能是用来监控redis中执行比较缓慢的一些操作，用LATENCY打印redis实例在跑命令时的耗时图表。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 只记录大于等于下边设置的值的操作，0的话，就是关闭监视。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 默认延迟监控功能是关闭的，如果你需要打开，也可以通过CONFIG SET命令动态设置。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">############################ EVENT NOTIFICATION ##############################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis can notify Pub/Sub clients about events happening in the key space.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">This feature is documented at http://redis.io/topics/notifications</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># For instance if keyspace events notification is enabled, and a client</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">performs a DEL operation on key &quot;foo&quot; stored in the Database 0, two</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">messages will be published via Pub/Sub:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># PUBLISH __keyspace@0__:foo del</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">PUBLISH __keyevent@0__:del foo</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># It is possible to select the events that Redis will notify among a set</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">of classes. Every class is identified by a single character:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  K     Keyspace events, published with __keyspace@&lt;db&gt;__ prefix.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> E     Keyevent events, published with __keyevent@&lt;db&gt;__ prefix.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> g     Generic commands (non-type specific) like DEL, EXPIRE, RENAME, ...</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> $     String commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> l     List commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> s     Set commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> h     Hash commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> z     Sorted set commands</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> x     Expired events (events generated every time a key expires)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> e     Evicted events (events generated when a key is evicted for maxmemory)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> A     Alias for g$lshzxe, so that the &quot;AKE&quot; string means all the events.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  The &quot;notify-keyspace-events&quot; takes as argument a string that is composed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> of zero or multiple characters. The empty string means that notifications</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> are disabled.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  Example: to enable list and generic events, from the point of view of the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">          event name, use:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  notify-keyspace-events Elg</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  Example 2: to get the stream of the expired keys subscribing to channel</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">            name __keyevent@0__:expired use:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  notify-keyspace-events Ex</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#  By default all notifications are disabled because most users don&#x27;</span>t need</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> this feature and the feature has some overhead. Note that <span class="keyword">if</span> you don<span class="string">&#x27;t</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> specify at least one of K or E, no events will be delivered.</span></span></span><br><span class="line">notify-keyspace-events &quot;&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">键空间通知使得客户端可以通过订阅频道或模式，来接收那些以某种方式改动了 Redis 数据集的事件。因为开启键空间通知功能需要消耗一些 CPU ，所以在默认配置下，该功能处于关闭状态。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">notify-keyspace-events 的参数可以是以下字符的任意组合，它指定了服务器该发送哪些类型的通知：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> K 键空间通知，所有通知以 __keyspace@__ 为前缀</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> E 键事件通知，所有通知以 __keyevent@__ 为前缀</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> g DEL 、 EXPIRE 、 RENAME 等类型无关的通用命令的通知</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> $ 字符串命令的通知</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> l 列表命令的通知</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> s 集合命令的通知</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> h 哈希命令的通知</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> z 有序集合命令的通知</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> x 过期事件：每当有过期键被删除时发送</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> e 驱逐(evict)事件：每当有键因为 maxmemory 政策而被删除时发送</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> A 参数 g$lshzxe 的别名</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">输入的参数中至少要有一个 K 或者 E，否则的话，不管其余的参数是什么，都不会有任何 通知被分发。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">############################## ADVANCED CONFIG ###############################</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Hashes are encoded using a memory efficient data structure when they have a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">small number of entries, and the biggest entry does not exceed a given</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">threshold. These thresholds can be configured using the following directives.</span></span></span><br><span class="line">hash-max-ziplist-entries 512</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">hash类型的数据结构在编码上可以使用ziplist和hashtable。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">ziplist的特点就是文件存储(以及内存存储)所需的空间较小,在内容较小时,性能和hashtable几乎一样。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">因此redis对hash类型默认采取ziplist。如果hash中条目的条目个数或者value长度达到阀值,将会被重构为hashtable。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">这个参数指的是ziplist中允许存储的最大条目个数，，默认为512，建议为128</span></span></span><br><span class="line">hash-max-ziplist-value 64</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">ziplist中允许条目value值最大字节数，默认为64，建议使用1024</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Lists are also encoded in a special way to save a lot of space.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The number of entries allowed per internal list node can be specified</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">as a fixed maximum size or a maximum number of elements.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">For a fixed maximum size, use -5 through -1, meaning:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">-5: max size: 64 Kb  &lt;-- not recommended for normal workloads</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">-4: max size: 32 Kb  &lt;-- not recommended</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">-3: max size: 16 Kb  &lt;-- probably not recommended</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">-2: max size: 8 Kb   &lt;-- good</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">-1: max size: 4 Kb   &lt;-- good</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Positive numbers mean store up to _exactly_ that number of elements</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">per list node.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The highest performing option is usually -2 (8 Kb size) or -1 (4 Kb size),</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">but if your use case is unique, adjust the settings as necessary.</span></span></span><br><span class="line">list-max-ziplist-size -2</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">当取正值的时候，表示按照数据项个数来限定每个quicklist节点上的ziplist长度。比如，当这个参数配置成5的时候，表示每个quicklist节点的ziplist最多包含5个数据项。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">当取负值的时候，表示按照占用字节数来限定每个quicklist节点上的ziplist长度。这时，它只能取-1到-5这五个值，每个值含义如下：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   -5: 每个quicklist节点上的ziplist大小不能超过64 Kb。（注：1kb =&gt; 1024 bytes）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   -4: 每个quicklist节点上的ziplist大小不能超过32 Kb。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   -3: 每个quicklist节点上的ziplist大小不能超过16 Kb。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   -2: 每个quicklist节点上的ziplist大小不能超过8 Kb。（-2是Redis给出的默认值）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   -1: 每个quicklist节点上的ziplist大小不能超过4 Kb。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Lists may also be compressed.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Compress depth is the number of quicklist ziplist nodes from *each* side of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the list to *exclude* from compression.  The head and tail of the list</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">are always uncompressed for fast push/pop operations.  Settings are:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">0: disable all list compression</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">1: depth 1 means &quot;don&#x27;</span>t start compressing <span class="keyword">until</span> after 1 node into the list,</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">   going from either the <span class="built_in">head</span> or <span class="built_in">tail</span><span class="string">&quot;</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   So: [head]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[tail]</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   [head], [tail] will always be uncompressed; inner nodes will compress.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">2: [head]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[tail]</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   2 here means: don&#x27;t compress head or head-&gt;next or tail-&gt;prev or tail,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   but compress all nodes between them.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">3: [head]-&gt;[next]-&gt;[next]-&gt;node-&gt;node-&gt;...-&gt;node-&gt;[prev]-&gt;[prev]-&gt;[tail]</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">etc.</span></span></span><br><span class="line">list-compress-depth 0</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">这个参数表示一个quicklist两端不被压缩的节点个数。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">注：这里的节点个数是指quicklist双向链表的节点个数，而不是指ziplist里面的数据项个数。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">实际上，一个quicklist节点上的ziplist，如果被压缩，就是整体被压缩的。</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">参数list-compress-depth的取值含义如下：</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   0: 是个特殊值，表示都不压缩。这是Redis的默认值。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   1: 表示quicklist两端各有1个节点不压缩，中间的节点压缩。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   2: 表示quicklist两端各有2个节点不压缩，中间的节点压缩。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   3: 表示quicklist两端各有3个节点不压缩，中间的节点压缩。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   依此类推…</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">由于0是个特殊值，很容易看出quicklist的头节点和尾节点总是不被压缩的，以便于在表的两端进行快速存取。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Sets have a special encoding in just one case: when a set is composed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">of just strings that happen to be integers in radix 10 in the range</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">of 64 bit signed integers.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The following configuration setting sets the limit in the size of the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">set in order to use this special memory saving encoding.</span></span></span><br><span class="line">set-max-intset-entries 512</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">数据量小于等于set-max-intset-entries用intset，大于set-max-intset-entries用set</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Similarly to hashes and lists, sorted sets are also specially encoded in</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">order to save a lot of space. This encoding is only used when the length and</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">elements of a sorted set are below the following limits:</span></span></span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">数据量小于等于zset-max-ziplist-entries用ziplist，大于zset-max-ziplist-entries用zset</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">HyperLogLog sparse representation bytes limit. The limit includes the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">16 bytes header. When an HyperLogLog using the sparse representation crosses</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">this limit, it is converted into the dense representation.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># A value greater than 16000 is totally useless, since at that point the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">dense representation is more memory efficient.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The suggested value is ~ 3000 in order to have the benefits of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the space efficient encoding without slowing down too much PFADD,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">which is O(N) with the sparse encoding. The value can be raised to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">~ 10000 when CPU is not a concern, but space is, and the data set is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">composed of many HyperLogLogs with cardinality in the 0 - 15000 range.</span></span></span><br><span class="line">hll-sparse-max-bytes 3000</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> value大小小于等于hll-sparse-max-bytes使用稀疏数据结构（sparse）</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 大于hll-sparse-max-bytes使用稠密的数据结构（dense），一个比16000大的value是几乎没用的，</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 建议的value大概为3000。如果对CPU要求不高，对空间要求较高的，建议设置到10000左右</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Streams macro node max size / items. The stream data structure is a radix</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">tree of big nodes that encode multiple items inside. Using this configuration</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">it is possible to configure how big a single node can be in bytes, and the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">maximum number of items it may contain before switching to a new node when</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">appending new stream entries. If any of the following settings are set to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">zero, the limit is ignored, so for instance it is possible to set just a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">max entires limit by setting max-bytes to 0 and max-entries to the desired</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">value.</span></span></span><br><span class="line">stream-node-max-bytes 4096</span><br><span class="line">stream-node-max-entries 100</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Active rehashing uses 1 millisecond every 100 milliseconds of CPU time in</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">order to help rehashing the main Redis hash table (the one mapping top-level</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">keys to values). The hash table implementation Redis uses (see dict.c)</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">performs a lazy rehashing: the more operation you run into a hash table</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">that is rehashing, the more rehashing &quot;</span>steps<span class="string">&quot; are performed, so if the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">server is idle the rehashing is never complete and some more memory is used</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">by the hash table.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The default is to use this millisecond 10 times every second in order to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">actively rehash the main dictionaries, freeing memory when possible.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># If unsure:</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">use &quot;</span>activerehashing no<span class="string">&quot; if you have hard latency requirements and it is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">not a good thing in your environment that Redis can reply from time to time</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">to queries with 2 milliseconds delay.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># use &quot;</span>activerehashing <span class="built_in">yes</span><span class="string">&quot; if you don&#x27;t have such hard requirements but</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">want to free memory asap when possible.</span></span></span><br><span class="line">activerehashing yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> Redis将在每100毫秒时使用1毫秒的CPU时间来对redis的hash表进行重新hash，可以降低内存的使用。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 当你的使用场景中，有非常严格的实时性需要，不能够接受Redis时不时的对请求有2毫秒的延迟的话，把这项配置为no。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 如果没有这么严格的实时性要求，可以设置为yes，以便能够尽可能快的释放内存</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">The client output buffer limits can be used to force disconnection of clients</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">that are not reading data from the server fast enough for some reason (a</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">common reason is that a Pub/Sub client can&#x27;t consume messages as fast as the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">publisher can produce them).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The limit can be set differently for the three different classes of clients:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># normal -&gt; normal clients including MONITOR clients</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">replica  -&gt; replica clients</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">pubsub -&gt; clients subscribed to at least one pubsub channel or pattern</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The syntax of every client-output-buffer-limit directive is the following:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># client-output-buffer-limit &lt;class&gt; &lt;hard limit&gt; &lt;soft limit&gt; &lt;soft seconds&gt;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># A client is immediately disconnected once the hard limit is reached, or if</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the soft limit is reached and remains reached for the specified number of</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">seconds (continuously).</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">So for instance if the hard limit is 32 megabytes and the soft limit is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">16 megabytes / 10 seconds, the client will get disconnected immediately</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">if the size of the output buffers reach 32 megabytes, but will also get</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">disconnected if the client reaches 16 megabytes and continuously overcomes</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the limit for 10 seconds.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># By default normal clients are not limited because they don&#x27;t receive data</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">without asking (in a push way), but just after a request, so only</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">asynchronous clients may create a scenario where data is requested faster</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">than it can read.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Instead there is a default limit for pubsub and replica clients, since</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">subscribers and replicas receive data in a push fashion.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Both the hard or the soft limit can be disabled by setting them to zero.</span></span></span><br><span class="line">client-output-buffer-limit normal 0 0 0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">对客户端输出缓冲进行限制可以强迫那些不从服务器读取数据的客户端断开连接，用来强制关闭传输缓慢的客户端。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">对于normal client，第一个0表示取消hard limit，第二个0和第三个0表示取消soft limit，normal client默认取消限制，因为如果没有寻问，他们是不会接收数据的</span></span></span><br><span class="line">client-output-buffer-limit replica 256mb 64mb 60</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 对于slave client和MONITER client，如果client-output-buffer一旦超过256mb，又或者超过64mb持续60秒，那么服务器就会立即断开客户端连接。</span></span></span><br><span class="line">client-output-buffer-limit pubsub 32mb 8mb 60</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string"> 对于pubsub client, 如果client-out-buffer一旦超过32mb，又或者超过8mb持续60秒，那么服务器会立即断开客户端连接。</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Client query buffers accumulate new commands. They are limited to a fixed</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">amount by default in order to avoid that a protocol desynchronization (for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">instance due to a bug in the client) will lead to unbound memory usage in</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the query buffer. However you can configure it here if you have very special</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">needs, such us huge multi/exec requests or alike.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># client-query-buffer-limit 1gb</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">In the Redis protocol, bulk requests, that are, elements representing single</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">strings, are normally limited ot 512 mb. However you can change this limit</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">here.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># proto-max-bulk-len 512mb</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis calls an internal function to perform many background tasks, like</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">closing connections of clients in timeout, purging expired keys that are</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">never requested, and so forth.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Not all tasks are performed with the same frequency, but Redis checks for</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">tasks to perform according to the specified &quot;</span>hz<span class="string">&quot; value.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># By default &quot;</span>hz<span class="string">&quot; is set to 10. Raising the value will use more CPU when</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis is idle, but at the same time will make Redis more responsive when</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">there are many keys expiring at the same time, and timeouts may be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">handled with more precision.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The range is between 1 and 500, however a value over 100 is usually not</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">a good idea. Most users should use the default of 10 and raise this up to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">100 only in environments where very low latency is required.</span></span></span><br><span class="line">hz 10</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">redis执行任务的频率为1s除以hz</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Normally it is useful to have an HZ value which is proportional to the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">number of clients connected. This is useful in order, for instance, to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">avoid too many clients are processed for each background task invocation</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in order to avoid latency spikes.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Since the default HZ value by default is conservatively set to 10, Redis</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">offers, and enables by default, the ability to use an adaptive HZ value</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">which will temporary raise when there are many connected clients.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># When dynamic HZ is enabled, the actual configured HZ will be used as</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">as a baseline, but multiples of the configured HZ value will be actually</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">used as needed once more clients are connected. In this way an idle</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">instance will use very little CPU time while a busy instance will be</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">more responsive.</span></span></span><br><span class="line">dynamic-hz yes</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">When a child rewrites the AOF file, if the following option is enabled</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the file will be fsync-ed every 32 MB of data generated. This is useful</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in order to commit the file to the disk more incrementally and avoid</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">big latency spikes.</span></span></span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">在aof重写的时候，如果打开了aof-rewrite-incremental-fsync开关，系统会每32MB执行一次fsync。</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">这对于把文件写入硬盘是有帮助的，可以避免过大的延迟峰值</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">When redis saves RDB file, if the following option is enabled</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the file will be fsync-ed every 32 MB of data generated. This is useful</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in order to commit the file to the disk more incrementally and avoid</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">big latency spikes.</span></span></span><br><span class="line">rdb-save-incremental-fsync yes</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Redis LFU eviction (see maxmemory setting) can be tuned. However it is a good</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">idea to start with the default settings and only change them after investigating</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">how to improve the performances and how the keys LFU change over time, which</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">is possible to inspect via the OBJECT FREQ command.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># There are two tunable parameters in the Redis LFU implementation: the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">counter logarithm factor and the counter decay time. It is important to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">understand what the two parameters mean before changing them.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The LFU counter is just 8 bits per key, it&#x27;s maximum value is 255, so Redis</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">uses a probabilistic increment with logarithmic behavior. Given the value</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">of the old counter, when a key is accessed, the counter is incremented in</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">this way:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1. A random number R between 0 and 1 is extracted.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">2. A probability P is calculated as 1/(old_value*lfu_log_factor+1).</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">3. The counter is incremented only if R &lt; P.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The default lfu-log-factor is 10. This is a table of how the frequency</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">counter changes with a different number of accesses with different</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">logarithmic factors:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># +--------+------------+------------+------------+------------+------------+</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">| factor | 100 hits   | 1000 hits  | 100K hits  | 1M hits    | 10M hits   |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">+--------+------------+------------+------------+------------+------------+</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">| 0      | 104        | 255        | 255        | 255        | 255        |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">+--------+------------+------------+------------+------------+------------+</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">| 1      | 18         | 49         | 255        | 255        | 255        |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">+--------+------------+------------+------------+------------+------------+</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">| 10     | 10         | 18         | 142        | 255        | 255        |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">+--------+------------+------------+------------+------------+------------+</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">| 100    | 8          | 11         | 49         | 143        | 255        |</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">+--------+------------+------------+------------+------------+------------+</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># NOTE: The above table was obtained by running the following commands:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash">#   redis-benchmark -n 1000000 incr foo</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">  redis-cli object freq foo</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># NOTE 2: The counter initial value is 5 in order to give new objects a chance</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">to accumulate hits.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The counter decay time is the time, in minutes, that must elapse in order</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">for the key counter to be divided by two (or decremented if it has a value</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">less &lt;= 10).</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The default value for the lfu-decay-time is 1. A Special value of 0 means to</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">decay the counter every time it happens to be scanned.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># lfu-log-factor 10</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">lfu-decay-time 1</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string">########################## ACTIVE DEFRAGMENTATION #######################</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># WARNING THIS FEATURE IS EXPERIMENTAL. However it was stress tested</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">even in production and manually tested by multiple engineers for some</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">time.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># What is active defragmentation?</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">-------------------------------</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Active (online) defragmentation allows a Redis server to compact the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">spaces left between small allocations and deallocations of data in memory,</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">thus allowing to reclaim back memory.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Fragmentation is a natural process that happens with every allocator (but</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">less so with Jemalloc, fortunately) and certain workloads. Normally a server</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">restart is needed in order to lower the fragmentation, or at least to flush</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">away all the data and create it again. However thanks to this feature</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">implemented by Oran Agra for Redis 4.0 this process can happen at runtime</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">in an &quot;</span>hot<span class="string">&quot; way, while the server is running.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Basically when the fragmentation is over a certain level (see the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">configuration options below) Redis will start to create new copies of the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">values in contiguous memory regions by exploiting certain specific Jemalloc</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">features (in order to understand if an allocation is causing fragmentation</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">and to allocate it in a better place), and at the same time, will release the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">old copies of the data. This process, repeated incrementally for all the keys</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">will cause the fragmentation to drop back to normal values.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># Important things to understand:</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 1. This feature is disabled by default, and only works if you compiled Redis</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   to use the copy of Jemalloc we ship with the source code of Redis.</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   This is the default with Linux builds.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 2. You never need to enable this feature if you don&#x27;t have fragmentation</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   issues.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># 3. Once you experience fragmentation, you can enable this feature when</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">   needed with the command &quot;</span>CONFIG SET activedefrag <span class="built_in">yes</span><span class="string">&quot;.</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="string"></span></span></span><br><span class="line"><span class="string"><span class="language-bash"># The configuration parameters are able to fine tune the behavior of the</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">defragmentation process. If you are not sure about what they mean it is</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">a good idea to leave the defaults untouched.</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Enabled active defragmentation</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">activedefrag yes</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Minimum amount of fragmentation waste to start active defrag</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">active-defrag-ignore-bytes 100mb</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Minimum percentage of fragmentation to start active defrag</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">active-defrag-threshold-lower 10</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Maximum percentage of fragmentation at which we use maximum effort</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">active-defrag-threshold-upper 100</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Minimal effort for defrag in CPU percentage</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">active-defrag-cycle-min 5</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Maximal effort for defrag in CPU percentage</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">active-defrag-cycle-max 75</span></span></span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Maximum number of set/hash/zset/list fields that will be processed from</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">the main dictionary scan</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">active-defrag-max-scan-fields 1000</span></span></span><br></pre></td></tr></table></figure>



<h1 id="2-客户端及监控"><a href="#2-客户端及监控" class="headerlink" title="2 客户端及监控"></a>2 客户端及监控</h1><h2 id="2-1-Java集群客户端"><a href="#2-1-Java集群客户端" class="headerlink" title="2.1 Java集群客户端"></a>2.1 Java集群客户端</h2><p>使用Lettuce客户端进行连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> LettuceConnectionFactory <span class="title function_">redisConnectionFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// master:192.168.254.160:6379    slave:192.168.254.160:6380</span></span><br><span class="line">        <span class="comment">// 默认slave只能进行读取，不能写入</span></span><br><span class="line">        <span class="comment">// 如果你的应用程序需要往redis写数据，建议连接master</span></span><br><span class="line">        System.out.println(<span class="string">&quot;使主从复制版本&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LettuceConnectionFactory</span>(<span class="keyword">new</span> <span class="title class_">RedisStandaloneConfiguration</span>(redisHost, redisPort));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h2 id="2-2-Monitor命令"><a href="#2-2-Monitor命令" class="headerlink" title="2.2 Monitor命令"></a>2.2 Monitor命令</h2><p>monitor 是一个调试命令，返回服务器处理的每个命令。对于发现程序的错误非常有用。</p>
<p>出于安全考虑，某些特殊管理命令CONFIG 不会记录到MONITOR输出</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6380&gt; monitor</span><br><span class="line">OK</span><br><span class="line">1607847163.243414 [0 192.168.254.160:6379] &quot;PING&quot;</span><br><span class="line">1607847171.203693 [0 192.168.254.160:6379] &quot;SELECT&quot; &quot;0&quot;</span><br><span class="line">1607847171.203703 [0 192.168.254.160:6379] &quot;set&quot; &quot;hash&quot; &quot;value&quot;</span><br><span class="line">1607847173.332260 [0 192.168.254.160:6379] &quot;PING&quot;</span><br><span class="line">1607847183.420434 [0 192.168.254.160:6379] &quot;PING&quot;</span><br><span class="line">1607847193.499993 [0 192.168.254.160:6379] &quot;PING&quot;</span><br><span class="line">1607847203.589087 [0 192.168.254.160:6379] &quot;PING&quot;</span><br><span class="line">1607847213.673100 [0 192.168.254.160:6379] &quot;PING&quot;</span><br><span class="line">1607847223.759230 [0 192.168.254.160:6379] &quot;PING&quot;</span><br></pre></td></tr></table></figure>

<p>运行一个MONITOR命令能够降低50%的吞吐量，运行多个MONITOR命令 降低的吞吐量更多。</p>
<h2 id="2-3-Info-命令"><a href="#2-3-Info-命令" class="headerlink" title="2.3 Info 命令"></a>2.3 Info 命令</h2><p>INFO命令以一种易于理解和阅读的格式，返回关于Redis服务器的各种信息和统计数值。</p>
<table>
<thead>
<tr>
<th>Info命令</th>
<th>返回信息</th>
</tr>
</thead>
<tbody><tr>
<td>server</td>
<td>Redis服务器的一般信息</td>
</tr>
<tr>
<td>clients</td>
<td>客户端的连接部分</td>
</tr>
<tr>
<td>memory</td>
<td>内存消耗相关信息</td>
</tr>
<tr>
<td>persistence</td>
<td>持久化相关信息</td>
</tr>
<tr>
<td>stats</td>
<td>一般统计</td>
</tr>
<tr>
<td>replication</td>
<td>主&#x2F;从复制信息</td>
</tr>
<tr>
<td>cpu</td>
<td>统计CPU的消耗</td>
</tr>
<tr>
<td>commandstats</td>
<td>Redis命令统计</td>
</tr>
<tr>
<td>cluster</td>
<td>Redis集群信息</td>
</tr>
<tr>
<td>keyspace</td>
<td>数据库的相关统计</td>
</tr>
</tbody></table>
<p>可以通过section 返回部分信息，如果没有使用任何参数时，默认为default。</p>
<h2 id="2-4-图形化监控工具-RedisLive"><a href="#2-4-图形化监控工具-RedisLive" class="headerlink" title="2.4 图形化监控工具 - RedisLive"></a>2.4 图形化监控工具 - RedisLive</h2><p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213163559881.png" alt="image-20201213163559881"></p>
<p>GitHub地址:<a target="_blank" rel="noopener" href="https://github.com/nkrode/RedisLive">https://github.com/nkrode/RedisLive</a></p>
<p><img src="https://raw.githubusercontent.com/chengchen901/img/master/blog/image-20201213163638307.png" alt="image-20201213163638307"></p>
<h1 id="3-实现Redis读写分离"><a href="#3-实现Redis读写分离" class="headerlink" title="3 实现Redis读写分离"></a>3 实现Redis读写分离</h1><h2 id="3-1-Java集群客户端"><a href="#3-1-Java集群客户端" class="headerlink" title="3.1 Java集群客户端"></a>3.1 Java集群客户端</h2><p>使用Lettuce客户端进行连接</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> LettuceConnectionFactory <span class="title function_">redisConnectionFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;使用读写分离版本&quot;</span>);</span><br><span class="line">        <span class="type">LettuceClientConfiguration</span> <span class="variable">clientConfig</span> <span class="operator">=</span> LettuceClientConfiguration.builder()</span><br><span class="line">                .readFrom(ReadFrom.SLAVE_PREFERRED)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// master:192.168.254.160:6379    slave:192.168.254.160:6380</span></span><br><span class="line">        <span class="comment">// 默认slave只能进行读取，不能写入</span></span><br><span class="line">        <span class="comment">// 如果你的应用程序需要往redis写数据，建议连接master</span></span><br><span class="line">        <span class="type">RedisStandaloneConfiguration</span> <span class="variable">serverConfig</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RedisStandaloneConfiguration</span>(redisHost, redisPort);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LettuceConnectionFactory</span>(serverConfig, clientConfig);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/13/07-Redis/03-Redis%E9%9B%86%E7%BE%A4/" data-id="clmcxeczl009tu8wa7djdezz5" data-title="Redis集群" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/12/13/07-Redis/04-Redis%E5%93%A8%E5%85%B5%E6%9C%BA%E5%88%B6/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Redis哨兵机制
        
      </div>
    </a>
  
  
    <a href="/2020/12/12/07-Redis/02-Redis%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Redis高级特性</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ActiveMQ/">ActiveMQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Docker/">Docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Dubbo/">Dubbo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Golang/">Golang</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java%E5%9F%BA%E7%A1%80/">Java基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/K8s/">K8s</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kafka/">Kafka</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MQ/">MQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mybatis/">Mybatis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Netty/">Netty</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/RPC/">RPC</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/RabbitMQ/">RabbitMQ</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Socker/">Socker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringBoot/">SpringBoot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringCloud/">SpringCloud</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tomcat/">Tomcat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ZooKeeper/">ZooKeeper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Zookeeper/">Zookeeper</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%A2%E8%AF%95%E9%A2%98/">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ActiveMQ/" rel="tag">ActiveMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CDH/" rel="tag">CDH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Dubbo/" rel="tag">Dubbo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Golang/" rel="tag">Golang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HDFS/" rel="tag">HDFS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K8s/" rel="tag">K8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KDTree/" rel="tag">KDTree</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kafka/" rel="tag">Kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MQ/" rel="tag">MQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MapReduce/" rel="tag">MapReduce</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/" rel="tag">Mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Netty/" rel="tag">Netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RPC/" rel="tag">RPC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/" rel="tag">RabbitMQ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Socker/" rel="tag">Socker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spark/" rel="tag">Spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringCloud/" rel="tag">SpringCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat/" rel="tag">Tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/YARN/" rel="tag">YARN</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ZooKeeper/" rel="tag">ZooKeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" rel="tag">多线程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B3%A8%E8%A7%A3/" rel="tag">注解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81/" rel="tag">集合源码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/ActiveMQ/" style="font-size: 10px;">ActiveMQ</a> <a href="/tags/CDH/" style="font-size: 10px;">CDH</a> <a href="/tags/Docker/" style="font-size: 18px;">Docker</a> <a href="/tags/Dubbo/" style="font-size: 13px;">Dubbo</a> <a href="/tags/Golang/" style="font-size: 19px;">Golang</a> <a href="/tags/HDFS/" style="font-size: 10px;">HDFS</a> <a href="/tags/K8s/" style="font-size: 10px;">K8s</a> <a href="/tags/KDTree/" style="font-size: 10px;">KDTree</a> <a href="/tags/Kafka/" style="font-size: 10px;">Kafka</a> <a href="/tags/MQ/" style="font-size: 10px;">MQ</a> <a href="/tags/MapReduce/" style="font-size: 10px;">MapReduce</a> <a href="/tags/MySQL/" style="font-size: 10px;">MySQL</a> <a href="/tags/Mybatis/" style="font-size: 14px;">Mybatis</a> <a href="/tags/Netty/" style="font-size: 14px;">Netty</a> <a href="/tags/RPC/" style="font-size: 11px;">RPC</a> <a href="/tags/RabbitMQ/" style="font-size: 15px;">RabbitMQ</a> <a href="/tags/Redis/" style="font-size: 17px;">Redis</a> <a href="/tags/Socker/" style="font-size: 10px;">Socker</a> <a href="/tags/Spark/" style="font-size: 11px;">Spark</a> <a href="/tags/Spring/" style="font-size: 20px;">Spring</a> <a href="/tags/SpringBoot/" style="font-size: 14px;">SpringBoot</a> <a href="/tags/SpringCloud/" style="font-size: 10px;">SpringCloud</a> <a href="/tags/Tomcat/" style="font-size: 13px;">Tomcat</a> <a href="/tags/YARN/" style="font-size: 11px;">YARN</a> <a href="/tags/ZooKeeper/" style="font-size: 12px;">ZooKeeper</a> <a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 16px;">多线程</a> <a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 10px;">注解</a> <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" style="font-size: 11px;">设计模式</a> <a href="/tags/%E9%9B%86%E5%90%88%E6%BA%90%E7%A0%81/" style="font-size: 13px;">集合源码</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 10px;">面试题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/09/10/11-MySQL/04-MySQL%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8F%8A%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/05-%E9%AB%98%E5%8F%AF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85%E6%90%AD%E5%BB%BA%E6%89%8B%E5%86%8C/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/09/10/11-MySQL/04-MySQL%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8F%8A%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/04-Sharding-JDBC%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/09/10/11-MySQL/04-MySQL%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8F%8A%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/03-MyCat%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/09/10/11-MySQL/04-MySQL%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8F%8A%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/02-MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/">(no title)</a>
          </li>
        
          <li>
            <a href="/2023/09/10/11-MySQL/04-MySQL%E9%AB%98%E5%8F%AF%E7%94%A8%E5%8F%8A%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB/01-MySQL%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%92%8C%E9%AB%98%E5%8F%AF%E7%94%A8/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>